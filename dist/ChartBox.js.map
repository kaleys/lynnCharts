{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap bfe260f8268e08989939","webpack:///./src/ChartBox.js","webpack:///external {\"root\":\"jQuery\",\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\"}","webpack:///./src/common.js","webpack:///./src/CandlestickChart.js","webpack:///./src/YAxisChart.js","webpack:///./src/VolumeChart.js","webpack:///./src/XAxisChart.js","webpack:///./src/PolylineChart.js","webpack:///./src/HollowCandleChart.js","webpack:///./src/MAChart.js","webpack:///./src/DragEvent.js","webpack:///./src/WheelEvent.js","webpack:///./src/vendor/jquery.mousewheel.min.js","webpack:///./src/CrossLineEvent.js","webpack:///./src/FollowTip.js","webpack:///./src/RightClickEvent.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;AACD,O;ACVA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,uBAAe;AACf;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;;;;;;ACtCA;AACA;AACA,YAAW,OAAO;AAClB;AACA;AACA,gBAAe,6BAA6B;AAC5C,yCAAwC;AACxC;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA,SAAQ;AACR;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,oBAAmB;AACnB,gBAAe,cAAc;AAC7B;AACA;AACA;AACA;AACA,UAAS;AACT,iB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,oBAAmB;AACnB;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP,eAAc;AACd;AACA;AACA;AACA;AACA;AACA,QAAO;AACP,eAAc;AACd;AACA;AACA;AACA;AACA,QAAO;AACP,SAAQ;AACR,iBAAgB;AAChB,WAAU;AACV,+B;AACA;AACA;AACA,KAAI;AACJ,YAAW;AACX;AACA,gCAA+B;AAC/B;AACA,KAAI;AACJ,eAAc;AACd;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA,yB;AACA;AACA,KAAI;;AAEJ;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA,uD;AACA;AACA;AACA;AACA,+BAA8B;AAC9B,WAAU;AACV;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6BAA4B;AAC5B;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA,SAAQ;AACR,yBAAwB,qBAAqB;AAC7C;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA;AACA,QAAO;AACP;AACA;AACA;AACA;AACA;AACA,QAAO;;AAEP,IAAG;AACH;AACA;AACA,KAAI;AACJ;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,KAAI;;AAEJ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wDAAuD;AACvD;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;;AAEA;;AAEA;AACA;AACA;AACA;AACA,cAAa,OAAO;AACpB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,sEAAqE;AACrE;AACA,0CAAyC,MAAM;AAC/C,2DAA0D,OAAO,QAAQ;AACzE;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+CAA8C;;AAE9C;;AAEA;AACA;;AAEA,uBAAsB,kDAAkD;;AAExE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA,kCAAiC,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA,yB;;AAEA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,wD;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,gE;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,kCAAiC,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;;AAGA;AACA;AACA,kCAAiC,OAAO;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,+EAA8E,QAAQ,sBAAsB;AAC5G;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA,oDAAmD,OAAO,SAAS;AACnE;;;AAGA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,cAAa,UAAU;AACvB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA,UAAS;;AAET;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA,U;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,U;AACA,iBAAgB;AAChB;;AAEA;AACA;AACA,cAAa,QAAQ;AACrB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,8BAA6B,kBAAkB;AAC/C;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,MAAM;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,sB;AACA;AACA,0CAAyC,aAAa;AACtD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA,I;;AAEA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;;;AAGA;AACA;AACA,cAAa,SAAS;AACtB,cAAa,SAAS;AACtB,cAAa,UAAU;AACvB,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL,KAAI;AACJ;AACA;AACA;AACA;AACA,MAAK;AACL;;AAEA;AACA;AACA;;AAEA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;AAEA;AACA;AACA,cAAa,YAAY;AACzB,cAAa,YAAY;AACzB,cAAa,WAAW;AACxB,cAAa,UAAU;AACvB,cAAa,YAAY;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,IAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc;AACd;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA,IAAG;;AAEH;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,QAAQ;AACrB,cAAa,QAAQ;AACrB,cAAa,SAAS;AACtB;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,OAAO;AACnB;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB,cAAa,OAAO;AACpB;AACA;AACA;AACA,cAAa,MAAM;AACnB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,KAAI;AACJ,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA,mBAAkB,kBAAkB;AACpC;AACA,MAAK;AACL;AACA;;AAEA;;AAEA;AACA;AACA,aAAY,MAAM;AAClB;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA,0BAAyB;AACzB;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB,qCAAqC;AACtD,uBAAsB,kDAAkD;AACxE;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa,OAAO;AACpB;AACA;AACA;AACA;;AAEA;AACA;AACA,aAAY,MAAM;AAClB,cAAa,QAAQ;AACrB;AACA;AACA;AACA,qBAAoB,iBAAiB;AACrC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;ACr0CA,gD;;;;;;;ACCA;AACA;AACA;AACA;AACA;AACA;AACA,eAAc,OAAO;AACrB;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6CAA4C,EAAE;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA,iBAAgB,SAAS;AACzB,iBAAgB,MAAM;AACtB,iBAAgB,OAAO;AACvB;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,kBAAiB;AACjB,cAAa;AACb;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA,UAAS;AACT;;AAEA;AACA;AACA;AACA;AACA,wBAAuB;AACvB,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA,UAAS;AACT;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;;AAEA,E;;;;;;ACtLA;AACA;AACA,WAAU;AACV;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;;AAEb,6BAA4B,cAAc;AAC1C;AACA;AACA;AACA;AACA;AACA;AACA;;;;AAIA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,U;;;AAGA;AACA;AACA;AACA;AACA,wCAAuC,OAAO;AAC9C;AACA;AACA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wF;AACA;;;AAGA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA,0BAAyB;;;AAGzB;AACA,0EAAyE;AACzE;;AAEA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA,MAAK;AACL;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,uCAAsC,OAAO;AAC7C;AACA;AACA,0BAAyB,kBAAkB;AAC3C;;AAEA,iDAAgD,kDAAkD;AAClG,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;;;AAIL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;;;;;;;AC5QA;AACA;AACA,WAAU;AACV;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,mBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,GAAE;;AAEF;;AAEA;;AAEA;;AAEA,6B;;;;;;ACxCA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,oBAAmB;;AAEnB;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,qBAAoB,gBAAgB;AACpC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,wCAAuC,OAAO;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA,0B;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA,sCAAqC,MAAM;AAC3C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,sBAAqB;;AAErB,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;;;AAGA;AACA;;AAEA,8B;;;;;;ACrIA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,oBAAmB;;AAEnB;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;;;AAGA;AACA;AACA,4BAA2B,MAAM;AACjC;AACA;AACA;AACA,kBAAiB,gBAAgB;AACjC;;AAEA;;AAEA;;AAEA,mBAAkB,kBAAkB;AACpC;AACA;;AAEA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA,mBAAkB,iBAAiB;AACnC;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;AACF;;AAEA,6B;;;;;;AClFA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,qBAAoB,gBAAgB;AACpC;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA,wCAAuC,OAAO;AAC9C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;;AAEA,MAAK;;AAEL;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,uCAAsC,OAAO;AAC7C;AACA;AACA,0BAAyB,kBAAkB;AAC3C;;AAEA,iDAAgD,kDAAkD;AAClG,MAAK;;AAEL;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,UAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,2B;;;;;;ACrJA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA,wE;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;AAIA,+B;;;;;;ACjCA;AACA;AACA,YAAW,OAAO;AAClB,YAAW,OAAO;AAClB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,uBAAsB;AACtB;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,uCAAsC,KAAK;AAC3C;AACA;AACA;AACA;;AAEA;AACA;AACA,cAAa;AACb;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;;AAEL;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,MAAM;AAC7C;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,MAAK;;AAEL;AACA;AACA;AACA;AACA,kCAAiC,mBAAmB,O;AACpD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,QAAQ;AAC/C;AACA;AACA;;AAEA;AACA;;AAEA;AACA,MAAK;;AAEL;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gI;AACA;;AAEA;;AAEA,0B;;;;;;AChKA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;AACH;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH;AACA;AACA,IAAG;AACH,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;;;AAGA;AACA;AACA;;AAEA,qB;AACA;AACA;AACA;AACA,yBAAwB;AACxB;AACA;;AAEA;AACA;;AAEA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AClGA;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA,sBAAqB,qBAAqB;AAC1C;AACA,KAAI;AACJ;AACA;;AAEA;AACA;AACA;;AAEA,6B;;;;;;ACtDA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,cAAa,qcAA+G,aAAa,cAAc,oEAAoE,kVAAkV,oBAAoB,4CAA4C,eAAe,yBAAyB,4CAA4C,eAAe,+PAA+P,mCAAmC,qCAAqC,+LAA+L,aAAa,OAAO,gBAAgB,oEAAoE,iNAAiN,uCAAuC,EAAE,6CAA6C,kCAAkC,kCAAkC,4CAA4C,EAAE,oCAAoC,yBAAyB,wHAAwH,qBAAqB,+CAA+C,EAAE,uCAAuC,4BAA4B,wFAAwF,2BAA2B,gEAAgE,kGAAkG,2BAA2B,qBAAqB,WAAW,wCAAwC,aAAa,uBAAuB,8DAA8D,0BAA0B,oCAAoC,EAAE,E;;;;;;ACP/iF;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAI;AACJ;AACA,KAAI;AACJ;AACA;AACA,KAAI;;AAEJ,IAAG;AACH;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,gCAA+B;AAC/B;AACA,KAAI;AACJ,2BAA0B,OAAO,gBAAgB;AACjD;;AAEA;AACA;AACA;AACA,iCAAgC,OAAO;AACvC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,wCAAuC,mCAAmC;AAC1E,OAAM;;AAEN;AACA;AACA,YAAW;AACX,IAAG;AACH;AACA;AACA;;AAEA;;AAEA;;AAEA;AACA,e;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;;;AAGH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA,iC;;;;;;ACjNA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA,cAAa;AACb;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,6EAA4E,oBAAoB,QAAQ,OAAO,wBAAwB;AACvI;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;AACA;;;AAGA,WAAU;;AAEV,GAAE;;AAEF;AACA;AACA,GAAE;;AAEF;AACA;AACA,GAAE;AACF;AACA;AACA;AACA,GAAE;AACF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;;;;;;AC7FA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,IAAG;AACH;AACA,GAAE;;AAEF;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,oBAAmB,mBAAmB;AACtC;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,wBAAuB,wBAAwB;AAC/C;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,MAAK;AACL;AACA;;;;AAIA;AACA;AACA;AACA;AACA;AACA,IAAG;;AAEH;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,4BAA2B,kBAAkB;AAC7C,KAAI;AACJ;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,MAAK;AACL;AACA,IAAG;AACH;AACA;;AAEA;AACA,GAAE;;AAEF;AACA;AACA;AACA,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA,oBAAmB,qBAAqB;AACxC;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,uDAAsD,iDAAiD;AACvG;;AAEA;AACA,IAAG;AACH,GAAE;;AAEF;AACA;AACA;;AAEA;;;;AAIA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,KAAI;AACJ;AACA;AACA,IAAG;AACH;AACA;AACA;AACA;AACA;;AAEA,KAAI;AACJ;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,MAAK;AACL;AACA,IAAG;;AAEH;AACA;AACA,IAAG;AACH;AACA;AACA;AACA,IAAG;;AAEH,GAAE;;AAEF;AACA;AACA;AACA;AACA;AACA;;AAEA,kC","file":"ChartBox.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"jquery\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"jquery\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"ChartBox\"] = factory(require(\"jquery\"));\n\telse\n\t\troot[\"ChartBox\"] = factory(root[\"jQuery\"]);\n})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {\nreturn \n\n\n/** WEBPACK FOOTER **\n ** webpack/universalModuleDefinition\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap bfe260f8268e08989939\n **/","/**\r\n * 图表的box\r\n * @param {object} opts {\r\n *     datas: [],\t\t\t//图表的数据\r\n *     container: Emement,\t//放在哪个容器里面\r\n *     title:{},\t\t\t//这个图表的标题，里面要包含title属性如 {title:EUR/USD,ask:1.33,bid:1.34}\r\n *     formatTitleTpl: function(title){}\t//生成title的html\r\n *     onTitleClick: function(){}\r\n *     width:500,\r\n *     height:200,\r\n *     minHeight:184\r\n *     ajax: { \t\t\t\t\t\t//如果己经设置了datas，那ajax将不会起作用\r\n *     \t\turl:StringOrFunction,\t//请求url\r\n *     \t\tdata: ObjectOrFunction,\t//url后面需要带的参数\r\n *     \t\tformatDatas:@function   //ajax请求成功之后，需要处理数据然后再使用\r\n *     },\r\n *     chartOpts:{\r\n *     \t\tperiod:1,   \t\t//时间段[1min,5min,15min,30min,1Hour,1Day,1Week,1Month]\r\n\t\t\tmaxShowCount: 800,\t//图表最多显示多少个数据\r\n\t\t\tminShowCount: 20,\t//图表最小显示多少个数据\r\n\t\t\ttheme {\r\n\t\t\t\tbackgroundColor:'#2e3138',  //背景颜色\r\n\t\t\t    riseColor: '#ff0000',       //涨颜色\r\n\t\t\t    fallColor: '#3dab4b',       //跌颜色\r\n\t\t\t    normalColor: '#999',        //不涨也不跌的时候字体的颜色\r\n\t\t\t    lineStyle: 'dashed',        //画底线或者边框的样式\r\n\t\t\t    lineColor: '#21242b',       //画底线或者边框的颜色\r\n\t\t\t    lineWidth: 1,               //画底线或者边框的线的宽度\r\n\t\t\t    barWidth: 5,               //柱子的宽度\r\n\t\t\t    spaceWidth: 2,              //柱子之间的间隔宽度\r\n\t\t\t}\r\n\r\n            //区域化分  \r\n\t\t    areas: {\r\n\t\t    \t//配置整个图表都有哪些区域，这些都需要能过areaName来找到配置\r\n\t\t    \titems:['mainArea','volumeArea'],\t主区域名字不能变\r\n\t\t    \t//每个区域公共的配置\r\n\t\t    \tright:30\r\n\t\t    },\r\n\t\t    //各字自区域对应的配置\r\n\t\t    mainArea: {\r\n\t\t    \tleft: 0,\r\n\t\t    \ttop: 30, \r\n\t\t    \tbottom:10,\t\t\t\t\t//规定在主区域内，canvas离区域的距离\r\n\t\t    \ttype:'candlestick',\t\t\t//规定这个区域内画什么图表类型，目前只支持candlestick和polyline类型\r\n\t\t    \tyAxis:true,\t\t\t\t\t//是否显示y轴，这个目前只对主区域有用，其他区域暂没做测试\r\n\t\t    \thorizontalLineSpace:55,\t\t//图形区域可能需要画一些刻度线，这里表示两条水平线之间的间隔\r\n\t\t    \tsubCharts: {\t\t\t\t//这里表是在这个区域内，可能还存在的一些副图\r\n\t\t    \t\t'MA5':{\t\t\t\t\t\t//副图标识:{type:副图是什么图表类型，color,daysCount\t    \t\t\t\t\t\t\t\t\r\n\t\t    \t\t\ttype:'MA',\t\t\t\t//后面这些配置可根据不同的图表类型，配置不同\r\n\t\t    \t\t\tcolor: 'rgb(255,70,251)',\r\n\t\t    \t\t\tdaysCount: 5,\r\n\t\t    \t\t\tsort:5,\t\t\t\t\t//sort表示在主图上显示副图的tip时显示的顺序，数字越大越在后\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA10':{\t\t\r\n\t\t    \t\t\ttype:'MA',\t\t\t\t\t//均线\r\n\t\t    \t\t\tcolor: 'rgb(227,150,34)',\t//线条的颜色\r\n\t\t    \t\t\tdaysCount: 10,\t\t\t\t//10日均线\r\n\t\t    \t\t\tsort:10,\t\t\t\t\t\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA20':{\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(53,71,107)',\r\n\t\t    \t\t\tdaysCount: 20,\r\n\t\t    \t\t\tsort:20,\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA60': {\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(0,0,0)',\r\n\t\t    \t\t\tdaysCount: 60,\r\n\t\t    \t\t\tsort:60,\r\n\t\t    \t\t}\r\n\t\t    \t}\r\n\t\t    },\r\n\t\t    volumeArea: {\t\t\t\t\t//因为在areas里配置了这个区域，所以也要有相应配置\r\n\t\t    \tleft: 0, top:30,bottom:0,\t//距离区域的距离\r\n\t\t    \ttype:'volume',\t\t\t\t//图表类型是交易量\r\n\t\t    \thorizontalLineSpace:50,\r\n\t\t    \theight: 50\t\t\t\t\t//图表的高度\t\t\t\t\r\n\t\t    },\t\r\n\t\t    subArea: {\r\n\t\t    \tleft: 0, top:30,bottom:0,\r\n\t\t    \theight: 80\r\n\t\t    },\t\r\n\t\t    xAxis: {\t\t\t\t\t\t//x轴配置\r\n\t\t    \tleft:0,top:0,bottom:0,\t\t\r\n\t\t        height: 30,\r\n\t\t\t    verticalLineSpace:100,\r\n\t\t        color:'#999',\r\n\t\t        font:'12px Arial'\r\n\t\t    },\r\n\t\t    yAxis: {\t\t\t\t\t\t//y轴配置,只有在区域里配置了yAxis为true后，才会调用这里面的配置\r\n\t\t        width: 60,\r\n\t\t        color:'#999',\r\n\t\t        lineColor: '#21242b',\r\n\t\t        font:'12px Arial'\r\n\t\t    },\r\n *     },\r\n *     events: {\t\t\t\t//主要是图表事件回调\r\n\t\t\tdrag: {\t\t\t\t//拖拽\r\n\t\t\t\tonDragBefore: function(){}\t\r\n\t\t\t\tonDrag: function(){}\r\n\t\t\t\tonDragAfter: function(){}\r\n\t\t\t},\r\n\t\t\twheel: {\t\t\t//鼠标滚轮\r\n\t\t\t\tstep:6,\t\t\t//鼠标每次滚动缩放的大小\r\n\t\t\t\tonBeforeWheel: function(){},\r\n\t\t\t\tonWheel: function(){}\r\n\t\t\t},\r\n\t\t\tcrossLine:{\t\t\t\t\t//鼠标移动事件\r\n\t\t\t\tlineColor:'#ccc',\t\t//移动画线是颜色\r\n\t\t\t\tbackground:'#3e4450',\t//x,y轴移动时显示数据背景颜色\r\n\t\t\t\tcolor:'#fff',\t\t\t//字体颜色\r\n\t\t\t\tfont:'12px Arial',\t\t//字体大小\r\n\t\t\t\tfollow: {\t\t\t\t//如果有这个配置，则显示移动时跟随的tip\r\n\t\t\t\t\twidth:120,\r\n\t\t\t\t\theight:160,\r\n\t\t\t\t\tmargin:20,\r\n\t\t\t\t\tdelay:1000\r\n\t\t\t\t}\r\n\t\t\t\tonCross:function(){}\t\r\n\t\t\t\tonAfterCross: function(){}\r\n\t\t\t},\r\n\r\n\t   }\r\n * }\r\n */\r\n\r\n\r\nvar $=require('jquery');\r\nvar core = require('./common.js');\r\nvar CandlestickChart = require('./CandlestickChart');\r\nvar VolumeChart = require('./VolumeChart');\r\nvar XAxisChart = require('./XAxisChart');\r\nvar PolylineChart = require('./PolylineChart');\r\nvar HollowCandleChart = require('./HollowCandleChart');\r\nvar MAChart = require('./MAChart');\r\nvar DragEvent = require('./DragEvent');\r\nvar WheelEvent = require('./WheelEvent');\r\nvar CrossLineEvent = require('./CrossLineEvent');\r\nvar RightClickEvent = require('./RightClickEvent');\r\n\r\n\r\nvar noop = function(){};\r\nvar isCanvasSuport = function(){\r\n\treturn !!document.createElement('canvas').getContext;\t\r\n}\r\nfunction Chartbox(opts) {\r\n\tvar defaults = {\r\n\t\tformatTitleTpl: function(){},\r\n\t\ttitle:{},\r\n\t\tcontainer: document.body,\r\n\t\tonTitleClick: noop,\r\n\t\tajax: {\r\n\t\t},\r\n\t\tchartOpts: {\r\n\t\t\tperiod:1,   //时间段[1min,5min,15min,30min,1Hour,1Day,1Week,1Month]\r\n\t\t\tmaxShowCount: 800,\r\n\t\t\tminShowCount: 20,\r\n\t\t\ttheme: {\r\n\t\t\t\tbackgroundColor:'#2e3138',  //背景颜色\r\n\t\t\t    riseColor: '#ff0000',       //涨颜色\r\n\t\t\t    fallColor: '#3dab4b',       //跌颜色\r\n\t\t\t    normalColor: '#999',        //不涨也不跌的时候字体的颜色\r\n\t\t\t    lineStyle: 'dashed',        //画底线或者边框的样式\r\n\t\t\t    lineColor: '#21242b',       //画底线或者边框的颜色\r\n\t\t\t    lineWidth: 1,               //画底线或者边框的线的宽度\r\n\t\t\t    barWidth: 5,               //柱子的宽度\r\n\t\t\t    spaceWidth: 2,              //柱子之间的间隔宽度\r\n\t\t\t    horizontalLineOpts: {\t\t//mainArea里画价格线的默认配置\r\n\t\t\t    \tcolor:'#fff',\r\n\t\t\t    \tbgColor:'#783f04',\r\n\t\t\t    \tlineColor:'yellow',\r\n\t\t\t    \tfont:'12px Arial'\r\n\t\t\t    }\r\n\t\t\t}, \r\n\t\t\t//区域化分  \r\n\t\t    areas: {\r\n\t\t    \t//都有哪些区域，这些都需要能过areaName来找到配置\r\n\t\t    \t//items:['mainArea','volumeArea','subArea'],主区域(mainArea)名字不能变\r\n\t\t    \titems:['mainArea','volumeArea'],\r\n\t\t    \t//每个区域公共的配置\r\n\t\t    \tright:60\r\n\t\t    },\r\n\t\t    //各字自区域对应的配置\r\n\t\t    mainArea: {\r\n\t\t    \tleft: 0,\r\n\t\t    \ttop: 30, \r\n\t\t    \tbottom:10,\r\n\t\t    \ttype:'candlestick',\r\n\t\t    \tyAxis:true,\r\n\t\t    \thorizontalLineSpace:55,\r\n\t\t    \tsubCharts: {\r\n\t\t    \t\t'MA5':{\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(255,70,251)',\r\n\t\t    \t\t\tdaysCount: 5,\r\n\t\t    \t\t\tsort:5,\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA10':{\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(227,150,34)',\r\n\t\t    \t\t\tdaysCount: 10,\r\n\t\t    \t\t\tsort:10,\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA20':{\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(53,71,107)',\r\n\t\t    \t\t\tdaysCount: 20,\r\n\t\t    \t\t\tsort:20,\r\n\t\t    \t\t},\r\n\t\t    \t\t'MA60': {\r\n\t\t    \t\t\ttype:'MA',\r\n\t\t    \t\t\tcolor: 'rgb(0,0,0)',\r\n\t\t    \t\t\tdaysCount: 60,\r\n\t\t    \t\t\tsort:60,\r\n\t\t    \t\t}\r\n\t\t    \t},\r\n\t\t    \tmarketPriceLine:{show:true,label:'市价'},\r\n\t\t    \tlines: {}\r\n\t\t    },\r\n\t\t    volumeArea: {\r\n\t\t    \tleft: 0, top:30,bottom:0,\r\n\t\t    \ttype:'volume',\r\n\t\t    \thorizontalLineSpace:50,\r\n\t\t    \theight: 50\r\n\t\t    },\r\n\t\t    subArea: {\r\n\t\t    \tleft: 0, top:30,bottom:0,\r\n\t\t    \theight: 80\r\n\t\t    },\r\n\t\t    xAxis: {\r\n\t\t    \tleft:0,top:0,bottom:0,\r\n\t\t        height: 30,\r\n\t\t\t    verticalLineSpace:100,\r\n\t\t        color:'#999',\r\n\t\t        font:'12px Arial'\r\n\t\t    },\r\n\t\t    yAxis: {\r\n\t\t        width: 100,\r\n\t\t        color:'#999',\r\n\t\t        lineColor: '#21242b',\r\n\t\t        font:'12px Arial'\r\n\t\t    },\r\n\t\t    \r\n\t\t},\r\n\t\tevents: {\r\n\t\t\tdrag: {\r\n\t\t\t},\r\n\t\t\twheel: {\r\n\t\t\t\tstep:6,\r\n\t\t\t},\r\n\t\t\tcrossLine:{\r\n\t\t\t\tlineColor:'#ccc',\r\n\t\t\t\tbackground:'#3e4450',\r\n\t\t\t\tcolor:'#fff',\r\n\t\t\t\tfont:'12px Arial'\r\n\t\t\t},\r\n\r\n\t\t}\r\n\t};\r\n\t$.extend(true,this,defaults,opts);\r\n\tif(!this.datas&&(!this.ajax||!this.ajax.url)) {\r\n\t\tconsole.log('请设置数据');\r\n\t\treturn false;\r\n\t}\r\n\tif(!this.container){\r\n\t\treturn false;\r\n\t}\r\n\tthis.container = $(this.container)\r\n\r\n\tif(!isCanvasSuport()) {\r\n\t\tthis.container.append('<div style=\"text-align:center;padding:20px 0\"><h1>您的浏览器不支持canvas</h1></div>');\r\n\t\treturn false;\r\n\t}\r\n\r\n\tthis.chartList = {};\r\n\tthis.eventList = {};\r\n\tthis.tipList = {};\r\n\tthis.readyList = [];\r\n\tvar me = this;\r\n\tthis.initComplete = false;\r\n\tthis.init();\r\n\tif(this.datas) {\r\n\t\tthis.datas = this.formatDatas(this.datas);\r\n\t\tthis.initChart();\r\n\t\tthis.initEventsObj();\r\n\t\tthis.execReadyList();\r\n\t\tthis.initComplete = true;\r\n\t}else if(this.ajax) {\r\n\t\tvar me  = this;\r\n\t\tthis.ajaxData(null,null,function(datas){\r\n\t\t\tme.datas = datas;\r\n\t\t\tme.initChart();\r\n\t\t\tme.initEventsObj();\r\n\t\t\tthis.execReadyList();\r\n\t\t\tthis.initComplete = true;\r\n\t\t});\r\n\t}\r\n\t\r\n}\r\n\r\nChartbox.prototype = {\r\n\tconstructor: Chartbox\r\n\t/**\r\n\t * 初始化\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t\r\n\t,init: function(){\r\n\t\tvar me = this;\r\n\t\tif(!this.width) {\r\n\t\t\tthis.width = this.container.width();\r\n\t\t\tthis.height = this.container.height();\r\n\t\t}\r\n\t\tvar html = '<div class=\"chart-box\" style=\"height:'+this.height+'px;width:'+this.width+'px\"><div class=\"box-header\"></div><div class=\"canvas-box\">'+\r\n\t\t\t\t\t\t\t'<div class=\"chart-status\"></div>'+\r\n\t\t\t\t\t\t\t'<canvas style=\"position:absolute;top:0;left:0\"></canvas>'+\r\n\t\t\t\t\t\t\t'<div class=\"canvas-tip\" style=\"position: absolute; top:0; left:0; width:100% \"></div>'\r\n\t\t\t\t\t\t'</div></div>';\r\n\t\t\r\n\t\tthis.wrap = $(html).appendTo(this.container);\r\n\t\tvar boxHeader = this.wrap.find('.box-header');\r\n\t\tthis.boxHeader = boxHeader;\r\n\t\tthis.canvasBox = this.wrap.find('.canvas-box');\r\n\t\tthis.canvasTipEle = this.canvasBox.find('.canvas-tip');\r\n\t\tthis.canvas = this.canvasBox.find('canvas')[0];\r\n\t\tthis.statusEle = this.canvasBox.find('.chart-status');\r\n\t\tthis.headerHeight = boxHeader.outerHeight();\t//边框没算进去\r\n\t\t\r\n\t\tthis.setTitle(this.title);\r\n\r\n\t\tthis.ctx = this.canvas.getContext('2d');\r\n\t\tthis.computedSize();\r\n\r\n\t\tthis.canvasBox.css({height:this.canvas.height,width:this.canvas.width});\r\n\r\n\t\tthis.boxHeader.on('click',function(e){\r\n\t\t\tvar target = $(e.target);\r\n\t\t\tfunction stopDefault(e){\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t\te.stopDefault();\r\n\t\t\t}\r\n\t\t\tif(target.is('.win-close')){\r\n\t\t\t\tme.destroy();\r\n\t\t\t\tstopDefault(e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(target.is('.win-big')) {\r\n\t\t\t\tme.zoomUp();\r\n\t\t\t\tstopDefault(e);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\tif(target.is('.win-small')) {\r\n\t\t\t\tme.zoomOut();\r\n\t\t\t\tstopDefault(e);\r\n\t\t\t\treturn ;\r\n\t\t\t}\r\n\t\t\tme.onTitleClick.call(me,me.title);\r\n\t\t})\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 初始化各种图表\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t,initChart: function(){\r\n\t\tthis.painting = true;\r\n\t\tvar me = this, chartOpts = this.chartOpts, areas = chartOpts.areas, items = areas.items, theme = chartOpts.theme;\r\n\t\tif(chartOpts.xAxis) {\r\n\t\t\titems.push('xAxis');\r\n\t\t}\r\n\t\t//获取表的需要显示的数据\r\n\t\tme.initBackgroundGrid(true);\r\n\t\tthis.getShowDatas();\r\n\t\t\r\n\r\n\t\tfor(var i=0,len = items.length; i<len;i++) {\r\n\t\t\tvar cur = items[i];\r\n\t\t\tthis.initAreaChart(cur);\r\n\t\t\tthis.initAreaTip(cur);\r\n\t\t}\r\n\t\tthis.drawMainAreaLines();\r\n\t\tthis.painting = false;\t\r\n\r\n\t}\r\n\r\n\t/**\r\n\t * 初始化canvas背景\r\n\t * @param  {[type]} resize [是否需要重新计算各高度]\r\n\t * @return {[type]}        [description]\r\n\t */\r\n\t,initBackgroundGrid: function(resize){\r\n\t\t//画背景\r\n\t\tif(resize) {\r\n\t\t\tvar isNormal = this.computedAreaHeight();\r\n\t\t\tif(isNormal===false) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar chartOpts = this.chartOpts,theme = chartOpts.theme;\r\n\t\tthis.drawBackground(this.canvas.width, this.canvas.height, theme.backgroundColor);\r\n\t\t\r\n\t\t\r\n\t\tif(chartOpts.yAxis&&chartOpts.yAxis.width) {\r\n\t\t\tvar width = this.mainRegionWidth + chartOpts.areas.right;\r\n\t\t\tcore.drawVLine(this.ctx, theme.lineColor, width, 0, this.canvas.height,'solid');\r\n\t\t}\r\n\t\tvar chartOpts = this.chartOpts, areas = chartOpts.areas, items = areas.items, theme = chartOpts.theme;\r\n\t\tvar top=0,left=0;\r\n\t\tfor(var i=0,len = items.length; i<len;i++) {\r\n\t\t\tvar cur = items[i];\r\n\t\t\tvar opts = chartOpts[cur];\r\n\t\t\tif(i!==0) {\r\n\t\t\t\tcore.drawHLine(this.ctx, theme.lineColor, left, top,this.canvas.width,'solid');\r\n\t\t\t}\r\n\t\t\tvar bottom = opts.bottom||0\r\n\t\t\ttop += (opts.top||0)+(bottom+1);\r\n\t\t\ttop += opts.height;\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * 画背景\r\n\t */\r\n\t,drawBackground: function(width, height, backgroundColor){\r\n\t\tvar ctx = this.ctx;\r\n\t\tctx.clearRect(0,0,width,height);\r\n\t\tif(backgroundColor) {\r\n            ctx.beginPath();\r\n            ctx.fillStyle = backgroundColor;\r\n            ctx.rect(0, 0, width, height);\r\n            ctx.fill();\r\n            ctx.closePath();\r\n        }\r\n\t}\r\n\r\n\t,computedSize: function(){\r\n\t\tvar computedHeight = this.height - this.headerHeight;\t\r\n\t\tvar computedWidth = this.width-2;\r\n\t\tthis.canvas.height = computedHeight;\r\n\t\tthis.canvas.width  = computedWidth;\r\n\t}\r\n\r\n\t//计算各区域的高度，有可能主屏高度是没有配置的，默认第一个是主图，除主图外所以的图没有高度默认80好了\r\n\t,computedAreaHeight: function(){\r\n\t\tvar chartOpts = this.chartOpts, areas = chartOpts.areas, items = areas.items;\r\n\t\t//y轴区域\r\n\t\tvar mainRegionWidth=0;\r\n\t\tif(chartOpts.yAxis&&chartOpts.yAxis.width) {\r\n\t\t\tmainRegionWidth = this.canvas.width - chartOpts.yAxis.width;\t\t\t\r\n\t\t}\r\n\t\tif(chartOpts.areas.right) {\r\n\t\t\tmainRegionWidth = mainRegionWidth - chartOpts.areas.right;\r\n\t\t}\r\n\t\tthis.mainRegionWidth = mainRegionWidth;\r\n\r\n\t\t//其他区域\r\n\t\tvar mainAreaHeight = 0,usedHeight=0,mainAreaKeyName;\r\n\t\t\r\n\t\tfor(var i=0,len = items.length; i<len;i++) {\r\n\t\t\tvar cur = items[i], opts = chartOpts[cur];\r\n\t\t\tif(!opts) {\r\n\t\t\t\tthrow new Error('没有设置'+cur+\"区域的配置\");\r\n\t\t\t}\r\n\t\t\tchartOpts[cur].width = this.mainRegionWidth;\r\n\t\t\tvar top = opts.top||0,bottom = opts.bottom||0;\r\n\t\t\t\r\n\t\t\tif(i==0) {\r\n\t\t\t\tmainAreaKeyName = cur;\r\n\t\t\t\tusedHeight += top + bottom;\r\n\t\t\t\tcontinue;\r\n\t\t\t}\r\n\t\t\topts.height = opts.height||80;\r\n\t\t\tusedHeight += top + opts.height + bottom;\r\n\r\n\t\t\t\r\n\t\t}\r\n\t\tchartOpts[mainAreaKeyName].height = this.canvas.height - usedHeight;\r\n\t\t\r\n\r\n\t\ti=0;\r\n\t\tusedHeight = 0;\r\n\t\tfor(var i=0,len = items.length; i<len;i++) {\r\n\t\t\tvar cur = items[i], opts = chartOpts[cur];\r\n\t\t\tchartOpts[cur].x = 0;\r\n\t\t\tchartOpts[cur].y  = usedHeight;\r\n\t\t\tchartOpts[cur].margin  = chartOpts.areas.right;\r\n\t\t\tvar bot = opts.bottom||0\r\n\t\t\tusedHeight +=(opts.top||0) + opts.height + (bot+1);\r\n\t\t}\r\n\t}\r\n\r\n\t//生成区域对应的图表\r\n\t,initAreaChart: function(areaName) {\r\n\t\tvar opts = this.chartOpts[areaName];\r\n\t\tif(areaName=='xAxis') {\r\n\t\t\topts.type  = 'xAxis';\r\n\t\t}\r\n\t\tif(!opts.type) {\r\n\t\t\tthrow new Error('请设置'+areaName+'区域的图表类型');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t//opts.width = this.mainRegionWidth;\r\n\r\n\t\tif(opts.subItem&&!opts.hasInit) {\r\n\t\t\tfor(var chart in opts.subItem) {\r\n\t\t\t\tthis.chartList[areaName]\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tvar type = opts.type.toString().toLowerCase();\r\n\t\tvar chartObj = this.chartObjFactory(type,areaName);\r\n\t\tif(chartObj) {\r\n\t\t\tthis.chartList[areaName] = chartObj;\r\n\t\t\tchartObj.painter();\r\n\t\t}\r\n\r\n\t\tif(opts.yAixs) {\r\n\t\t\tvar yAixsChart = this.chartObjFactory('yaixs',areaName);\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t,changeAreaChart: function(areaName,opts) {\r\n\t\tvar oldOpts = this.chartOpts[areaName];\r\n\t\tif(!oldOpts) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tdelete oldOpts.high;\r\n\t\tdelete oldOpts.low;\r\n\t\tif(opts) {\r\n\t\t\t$.extend(true,oldOpts,opts);\r\n\t\t\tthis.chartOpts[areaName] = oldOpts;\r\n\t\t}\r\n\t\tvar height = oldOpts.height+oldOpts.top+oldOpts.bottom;\r\n\t\tvar theme = this.chartOpts.theme;\r\n\t\tthis.drawBackground(this.width,height, theme.backgroundColor);\r\n\t\tcore.drawVLine(this.ctx, theme.lineColor, this.mainRegionWidth+oldOpts.margin, oldOpts.y, height,'solid');\r\n\t\t\r\n\r\n\t\tthis.initAreaChart(areaName);\r\n\t\tthis.drawMainAreaLines();\r\n\r\n\t}\r\n\r\n\t,initAreaTip: function(areaName) {\r\n\t\tvar opts = this.chartOpts[areaName];\r\n\t\tif(!opts||areaName=='xAxis') {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar index = this.showDatas.length-1;\r\n\t\tvar tip = this.getAreaTip(areaName,index);\r\n\t\tif(tip) {\r\n\t\t\tthis.tipList[areaName] = $('<div class=\"area-tip\" style=\"position:absolute; left:0; top:'+(opts.y+2)+'px;\" >'+tip+'</div>').appendTo(this.canvasTipEle);\r\n\t\t}\r\n\t}\r\n\r\n\t,getAreaTip: function(areaName,index,follow) {\r\n\t\tvar chartList = this.chartList;\r\n\t\tvar tip='';\r\n\t\tif(chartList[areaName]) {\r\n\t\t\ttip += chartList[areaName].getTip(index,follow);\r\n\t\t\tvar areaSubItem = chartList[areaName+\"subItem\"];\r\n\t\t\tif(areaSubItem&&areaSubItem.getTip) {\r\n\t\t\t\ttip += areaSubItem.getTip.call(areaSubItem,index,follow);\r\n\t\t\t}\r\n\t\t\tvar chartSubItem = chartList[areaName].subItem;\r\n\t\t\tif(chartSubItem&&chartSubItem.getTip) {\r\n\t\t\t\ttip += chartSubItem.getTip.call(chartSubItem,index,follow);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn tip;\r\n\t}\r\n\r\n\t,initEventsObj: function(){\r\n\t\tif(!this.events) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tvar canvas = $('<canvas style=\"position:absolute; top:0; left: 0;\" width=\"'+this.canvas.width+'\" height=\"'+this.canvas.height+'\"></canvas>').insertBefore(this.canvasTipEle);\r\n\t\tthis.eventsCanvas = canvas[0];\r\n\r\n\r\n\t\tif(this.events.drag) {\r\n\t\t\tthis.eventList['drag'] = new DragEvent(this.eventsCanvas,this);\r\n\t\t}\r\n\r\n\t\tif(this.events.wheel) {\r\n\t\t\tthis.eventList['wheel'] = new WheelEvent(this.eventsCanvas,this);\r\n\t\t}\r\n\r\n\t\tif(this.events.crossLine) {\r\n\t\t\tthis.eventList['crossLine'] = new CrossLineEvent(this.eventsCanvas,this);\r\n\t\t}\r\n\r\n\t\tif(this.events.rightClick) {\r\n\t\t\tthis.eventList['rightClick'] = new RightClickEvent(this.eventsCanvas,this);\r\n\t\t}\r\n\r\n\t}\r\n\r\n\t,execReadyList: function(){\r\n\t\twhile(this.readyList.length) {\r\n\t\t\tvar fn = this.readyList.shift();\r\n\t\t\tfn&&fn();\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 各种不同种类的chart工厂方法\r\n\t * @param  {[string]}  type      [插入类型]\r\n\t * @param  {[string]}  areaName  [所在的区域名称]\r\n\t * @param  {[boolean]} subId [是否是所以区域里的子chart]\r\n\t * @return {[object]}            [返回生成的对象]\r\n\t */\r\n\t,chartObjFactory: function(type,areaName,subId){\r\n\t\tvar chartObj;\r\n\t\tvar type = type.toString().toLowerCase();\r\n\t\tswitch(type) {\r\n\t\t\tcase 'candlestick':\r\n\t\t\t\tchartObj = new CandlestickChart(areaName, this, subId);\r\n\t\t\tbreak;\r\n\t\t\tcase 'hollowcandle':\r\n\t\t\t\tchartObj = new HollowCandleChart(areaName, this, subId);\r\n\t\t\tbreak;\r\n\t\t\tcase 'polyline':\r\n\t\t\t\tchartObj = new PolylineChart(areaName, this, subId);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'volume':\r\n\t\t\t\tchartObj = new VolumeChart(areaName, this, subId);\r\n\t\t\tbreak;\r\n\t\t\tcase 'xaxis':\r\n\t\t\t\tchartObj = new XAxisChart(areaName, this, subId);\r\n\t\t\tbreak;\r\n\t\t\tcase 'ma':\r\n\t\t\t\tchartObj = new MAChart(areaName,this, subId);\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\treturn chartObj;\r\n\t}\r\n\r\n\t/**\r\n\t * 计算当前所在图表需要显示数据在所在数据里面的索引\r\n\t * @return {[obj]} [显示数据的起始索引]\r\n\t */\r\n\t,calcDataRanges: function(){\r\n\t\tvar chartOpts  = this.chartOpts, theme = chartOpts.theme, datas = this.datas;\r\n\t\tvar needResetBarWidth = this.zoom, maxDataLength = datas.length, totalWidth = this.mainRegionWidth;\r\n\t\tif(this.dataRanges == null) {\r\n            //计算dataRanges\r\n            var dataCount = Math.ceil(totalWidth / (theme.spaceWidth + theme.barWidth));\r\n            if (dataCount > maxDataLength){\r\n                dataCount = maxDataLength;\r\n                needResetBarWidth = true;\r\n            };\r\n            this.dataRanges = {\r\n                start: maxDataLength - dataCount,\r\n                to: maxDataLength -1,\r\n            };\r\n        }\r\n\r\n\r\n        //检查dataRanges是否合理\r\n        var startIndex = this.dataRanges.start, toIndex = this.dataRanges.to;\r\n        var itemsCount = this.dataRanges.to - this.dataRanges.start+1;\r\n        var minShowCount = chartOpts.minShowCount,maxShowCount = chartOpts.maxShowCount;\r\n\r\n        /*var tempDataRanges = this.checkDataRanges();\r\n        var tempCount = tempDataRanges.to - tempDataRanges.start +1;\r\n\r\n        if(tempCount!==itemsCount) {\r\n        \tneedResetBarWidth = true;\r\n        \titemsCount =tempCount;\r\n        }*/\r\n\r\n        if(needResetBarWidth) {\r\n            var spaceWidth,barWidth;\r\n            var perWidth = this.mainRegionWidth/itemsCount;\r\n            barWidth = Math.ceil(perWidth*2/3);\r\n            barWidth = barWidth >= perWidth ? perWidth: barWidth;\r\n            if(barWidth<=2) {\r\n                spaceWidth = 0;\r\n            }else {\r\n                spaceWidth = perWidth - barWidth;\r\n            }\r\n            spaceWidth = perWidth - barWidth;\r\n            chartOpts.theme.barWidth = barWidth;\r\n            chartOpts.theme.spaceWidth = spaceWidth;\r\n            \r\n            this.zoom = false;\r\n        }\r\n\r\n        return this.dataRanges;\r\n\t}\r\n\r\n\t,checkDataRanges: function(dataRanges){\r\n\r\n\t\tvar dataRanges = dataRanges||this.dataRanges;\r\n\t\tvar startIndex = dataRanges.start,toIndex = dataRanges.to;\r\n        var itemsCount = toIndex - startIndex + 1;\r\n\r\n        var start = startIndex,to = toIndex, chartOpts = this.chartOpts, maxDataLength = this.datas.length;\r\n        var minShowCount = chartOpts.minShowCount,maxShowCount = chartOpts.maxShowCount;\r\n        //处理临界值，主要是拖拽\r\n        if( to< minShowCount) {\r\n        \tto = minShowCount -1;\r\n        \tstart = to - itemsCount;\r\n        }else if(start > maxDataLength - minShowCount){\r\n        \tstart = maxDataLength - minShowCount;\r\n        \tto = start + itemsCount -1;\r\n        }        \r\n        //处理是否显示在最大个数与最小个数之间,主要是缩放\r\n        \r\n        if(itemsCount<minShowCount) {\r\n        \tstart = to - (minShowCount-1)\r\n        }\r\n        if(itemsCount > maxShowCount) {\r\n        \tstart = to - (maxShowCount-1)\r\n        }                \r\n        return {start: start,to :to}\r\n\t}\r\n\r\n\t/**\r\n\t * 跟据起始索引得到显示在图表上的数据\r\n\t * @return {[Array]}      [返回数据数组]\r\n\t */\r\n\t,getShowDatas: function(){\r\n\t\tif(!this.dataRanges||this.zoom) {\r\n\t\t\tthis.calcDataRanges();\r\n\t\t}\r\n\t\tvar dataRanges = this.dataRanges, datas = this.datas, maxDataLength = datas.length,totalWidth = this.mainRegionWidth;\r\n\t\tvar filteredData = [];\r\n\t\tfor(var i=dataRanges.start; i<=dataRanges.to; i++) {\r\n\t\t\tif(i < 0||i>maxDataLength-1) {\r\n\t\t\t\tfilteredData.push(false);\r\n\t\t\t}else {\r\n\t\t\t\tfilteredData.push(datas[i]);\r\n\t\t\t}\r\n\t\t}\r\n        this.showDatas = filteredData;\r\n\t}\r\n\t\r\n\t,calcAreaDataValueRange: function(areaName){\r\n\t\tvar datas = this.showDatas;\r\n        var opts = this.chartOpts[areaName];\r\n        var high,low,dotLen=3;\r\n        for(var line in opts.lines) {\r\n            var cur = opts.lines[line];\r\n            high = high ? Math.max(cur.value,high) : cur.value;\r\n            low = low ? Math.min(cur.value,low) : cur.value;\r\n        }\r\n        for(var i=0,len = datas.length;i<len;i++) {\r\n            var val = datas[i];\r\n            if(val) {\r\n                high = high ? Math.max(val.high, high) : val.high;\r\n                low = low ? Math.min(low, val.low) : val.low;\r\n                var highStr = val.high.toString(), highDotLen = highStr.length - highStr.indexOf('.') -1;\r\n                dotLen = Math.max(highDotLen,dotLen);\r\n            }\r\n        }\r\n        this.chartOpts[areaName].high = high;\r\n        this.chartOpts[areaName].low = low;\r\n        if(!this.chartOpts[areaName].length){\r\n            this.chartOpts[areaName].dotLen = dotLen\r\n        }\r\n\t}\r\n\r\n\t//这四个方法由于设计上的缺陷，现没有办法更好的优化了，不应该放到这个对象里的，应该放到Area【新建】对象里\r\n\t,drawMainAreaLines: function(isDrawMarketPrice){\r\n\t\tvar isDraw = isDrawMarketPrice;\r\n\t\tvar mainAreaOpts = this.chartOpts.mainArea;\r\n\t\tif(isDraw!==false){\t\t\t\r\n\t\t\tif(mainAreaOpts.marketPriceLine&&mainAreaOpts.marketPriceLine.show) {\r\n\t\t\t\tthis.drawMainAreaLine('marketPrice',{'label':'市价'})\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar lines = mainAreaOpts.lines||{};\r\n\t\tvar isExceed = false;\r\n\t\tfor(var line in lines) {\r\n\t\t\tvar value = lines[line].value;\r\n\t\t\tif(value > mainAreaOpts.high || value < mainAreaOpts.low) {\r\n\t\t\t\tisExceed = true;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(!isExceed) {\r\n\t\t\tfor(var l in lines) {\r\n\t\t\t\tvar opts = lines[l];\r\n\t\t\t\tthis.drawMainAreaLine(l,opts);\r\n\t\t\t}\r\n\t\t}else{\r\n\t\t\tthis.painter();\r\n\t\t}\r\n\t}\r\n\t,drawMainAreaLine: function(key,lineOpts){\r\n\t\tvar defaultOpts = this.chartOpts.theme.horizontalLineOpts,ctx = this.ctx;\r\n\t\tvar opts = $.extend({},defaultOpts,lineOpts);\r\n\t\tif(key=='marketPrice') {\r\n\t\t\tvar latestData = this.datas[this.datas.length-1]\r\n\t\t\topts.value = latestData.close;\r\n\t\t\tvar color = this.getColor(latestData.close,latestData.open);\r\n\t\t\tif(!color) {\r\n\t\t\t\tcolor = defaultOpts.bgColor;\r\n\t\t\t}\r\n\t\t\topts.lineColor = opts.bgColor = color;\r\n\t\t}\r\n\r\n\t\tif(!opts.value) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t//得到y轴的坐标\r\n\t\tvar y = this.getYByValue(opts.value,'mainArea');\r\n\t\tif(!y) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar mainAreaOpts = this.chartOpts.mainArea;\r\n\t\tctx.save();\r\n\t\tctx.translate(mainAreaOpts.left,mainAreaOpts.top);\r\n\r\n\t\t//画线\r\n\t\tvar w = this.mainRegionWidth +this.chartOpts.areas.right;\r\n\t\tcore.drawHLine(this.ctx,opts.lineColor, 0, y, w, 'dashed');\r\n\t\t//画Y轴的数据\r\n\t\tvar yAxisWidth = this.chartOpts.yAxis.width;\r\n\t\tctx.fillStyle = opts.bgColor;\r\n\t\tctx.fillRect(w+1, y-10, yAxisWidth, 20);\r\n\t\tctx.strokeStyle = this.chartOpts.theme.lineColor;\r\n\t\tctx.strokeRect(w+1, y-10, yAxisWidth, 20);\r\n\t\tctx.fillStyle = opts.color;\r\n\t\tctx.font = opts.font;\r\n\t\tvar text = core.toMoney(opts.value,mainAreaOpts.dotLen);\r\n\t\tctx.fillText(text,w+7, y+5);\r\n\t\tif(opts.label) {\r\n\t\t\tctx.textAlign = 'end';\r\n\t\t\tctx.fillText(opts.label,this.canvas.width-5,y+5);\r\n\t\t}\r\n\t\t\r\n\t\tthis.ctx.restore();\r\n\t}\r\n\t,setMainAreaLines: function(){\r\n\t\tvar args = arguments;\r\n\t\tif(args.length==1) {\r\n\t\t\tthis.chartOpts.mainArea.lines = args[0]\r\n\t\t}else if(args.length==2) {\r\n\t\t\tvar lines = this.chartOpts.mainArea.lines||{};\r\n\t\t\tif(!args[1]) return false;\r\n\t\t\tvar key = args[0],opts = args[1];\r\n\t\t\tif(lines.key) {\r\n\t\t\t\tdelete lines.key\r\n\t\t\t}\r\n\t\t\tlines[key] = opts;\r\n\t\t}\t\r\n\t\t\r\n\t}\r\n\t,deleteMainAreaLine: function(key){\r\n\t\tvar lines = this.chartOpts.mainArea.lines;\r\n\t\tif(key) {\r\n\t\t\tdelete this.chartOpts.mainArea.lines[key]\r\n\t\t}else{\r\n\t\t\tthis.chartOpts.mainArea.lines = {}\r\n\t\t}\r\n\t}\r\n\t//end\r\n\t\r\n\t\r\n\t/**\r\n\t * 画图，初始化的时候不需要\r\n\t * @param  {[object]} dataRanges [数据范围]\r\n\t * @param  {[object]} opts       [需要重置的配置，或者回调函数]\r\n\t * @param  {[boolean]} resize     [是否需要重新计算size]\r\n\t * @return {[type]}            [description]\r\n\t */\r\n\t,painter: function(dataRanges,opts,resize) {\r\n\t\tvar args = arguments;\r\n\t\tif(this.painting==true) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\tif(dataRanges) {\r\n\t\t\tvar tempRanges  = this.checkDataRanges(dataRanges);\r\n\t\t\tif(this.dataRanges.to ==tempRanges.to&& this.dataRanges.start == tempRanges.start) {\r\n\t\t\t\treturn false;\r\n\t\t\t}else {\r\n\t\t\t\tthis.dataRanges = tempRanges;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar callback;\r\n\t\tif($.type(args[1])=='object') {\r\n\t\t\tthis.chartObj = $.extend(true,this.chartObj,opts);\r\n\t\t}else if($.type(args[1])=='function') {\r\n\t\t\tcallback = args[1];\r\n\t\t}\r\n\r\n\t\tthis.painting = true;\r\n\t\tthis.initBackgroundGrid(resize);\r\n\t\t//重新计算需要显示的数据\r\n\t\tthis.getShowDatas();\r\n\r\n\t\tvar chartList = this.chartList;\r\n\t\tfor(var chart in chartList) {\r\n\t\t\tchartList[chart].painter();\r\n\t\t}\r\n\t\tthis.drawMainAreaLines();\r\n\t\tthis.painting = false;\r\n\t\tcallback&&callback();\r\n\t}\r\n\r\n\t/**\r\n\t * 当painter.start<0自动去加载数据\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t,autoLoadData: function(){\r\n\t\tvar me = this,datas = me.datas, len = datas.length, dataRanges = this.dataRanges;\r\n\t\tif(dataRanges.start>=0&&dataRanges.to<len){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar autoTime = this.autoTimestamp;\r\n\t\tvar now = +new Date();\r\n\t\tif( !autoTime||now - autoTime >1000) {\r\n\t\t\tif(dataRanges.start < 0) {\r\n\t\t\t\tvar startX = me.datas[0]['quoteTime'];\r\n\t\t\t\tme.ajaxData(null ,startX, function(datas){\r\n\t\t\t\t\tme.appendDatas(datas,-1);\r\n\t\t\t\t\tme.painter();\r\n\t\t\t\t})\r\n\t\t\t}else if(dataRanges.to > me.datas.length-1) {\r\n\t\t\t\tvar endX = me.datas[me.datas.length-1]['quoteTime'];\r\n\t\t\t\tme.ajaxData(endX, null, function(datas){\r\n\t\t\t\t\tme.appendDatas(datas,1);\r\n\t\t\t\t\tme.painter();\r\n\t\t\t\t})\r\n\t\t\t}\r\n\r\n\t\t\tthis.autoTimestamp = now;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * 添加数据\r\n\t * @param  {[Array]} datas [需要添加数据]\r\n\t * @param  {[int ]} dir   [-1：向左添加 1：向右添加]\r\n\t * @return {[type]}       [description]\r\n\t */\r\n\t,appendDatas: function(datas,dir) {\r\n\t\tvar dataRanges = this.dataRanges, start = dataRanges.start, to = dataRanges.to;\r\n\t\tvar count = datas.length;\r\n\t\tif(dir==-1||start < 0) {\r\n\t\t\tArray.prototype.unshift.apply(this.datas,datas);\r\n\t\t\tthis.dataRanges = {start: start+count, to: to+count};\r\n\t\t\tfor(var event in this.eventList) {\r\n\t\t\t\tif(this.eventList[event].dataRanges) {\r\n\t\t\t\t\tthis.eventList[event].dataRanges = this.dataRanges;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}else if(dir==1||to > this.datas.length-1) {\r\n\t\t\tArray.prototype.push.apply(this.datas,datas);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 使用ajax去加载数据\r\n\t * @param  {[timestamp]} startX     [开始时间,返回这个时间之后的1000条数据，包括他本身]\r\n\t * @param  {[timestamp]} endX       [结束时间,返回这个时间之前的1000条数据，包括他本身]\r\n\t * @param  {[function]} callbackFn  [回调函数]\r\n\t * @param  {[boolean]}  isFormat  \t[是否格式化返回回来的数据,为false才不格式化]\r\n\t * @return {[undefined]}            [description]\r\n\t */\r\n\t,ajaxData: function(startX,endX,callbackFn,isFormat,showLoading){\r\n\t\tvar ajax = this.ajax;\r\n\t\tif(!ajax&&!ajax.url) {\r\n\t\t\treturn ;\r\n\t\t}\r\n\t\tif(this.ajaxing) {\r\n\t\t\treturn ;\r\n\t\t}\r\n\r\n\t\tif(startX && startX==this.maxTimestamp) {\r\n\t\t\tcallbackFn&&callbackFn.call(me,[]);\r\n\t\t\treturn ;\r\n\t\t}else if(endX && this.hasNoLeftData ){\r\n\t\t\tcallbackFn&&callbackFn.call(me,[]);\r\n\t\t\treturn ;\r\n\t\t}\r\n\r\n\r\n\t\tvar me = this;\r\n\t\tthis.ajaxing = true;\r\n\t\tif(showLoading!==false){\r\n\t\t\tthis.statusEle.html('<span class=\"chart-icon chart-load\"></span><span class=\"chart-text\">正在加载数据。。。</span>')\r\n\t\t}\r\n\r\n\t\tvar url = ajax.url;\r\n\t\tif($.type(url)=='function') {\r\n\t\t\turl = url.call(me);\r\n\t\t}\r\n\t\t\r\n\t\tvar data = {};\r\n\t\tif($.type(ajax.data)=='object') {\r\n\t\t\tdata = ajax.data;\r\n\t\t}else if($.type(ajax.data)=='function') {\r\n\t\t\tdata = ajax.data.call(me, startX, endX );\r\n\t\t}\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: url,\r\n\t\t\tdata: data,\r\n\r\n\t\t}).done(function(response){\r\n\t\t\tme.ajaxing  = false;\r\n\t\t\tvar data = response;\r\n\t\t\tif( ajax.formatDatas && $.type(ajax.formatDatas)=='function' ) {\r\n\t\t\t\tdata = ajax.formatDatas.call(me,response);\r\n\t\t\t}\r\n\t\t\tif(!data) {\r\n\t\t\t\terror()\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif($.type(data)!=='array'){\r\n\t\t\t\tthrow new Error('数据格式不正确');\r\n\t\t\t}\r\n\t\t\tif(!data.length) {\r\n\t\t\t\tif(endX) {me.hasNoLeftData = true}\r\n\t\t\t\terror()\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tif(me.datas) {\r\n\t\t\t\tvar currDatas = me.datas;\r\n\t\t\t\t//说明往左加载数据，最后一个数据可能需要去重，因为返回的数据是双闭合状态，也有可能不是，返回现在情部用的是双闭合\r\n\t\t\t\tif(endX) {\r\n\t\t\t\t\tvar lastData = data[data.length-1];\r\n\t\t\t\t\tif(lastData[0]==currDatas[0]['quoteTime']) {\r\n\t\t\t\t\t\tdata.pop();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t//表明左侧数据己经没有可以加载的了\r\n\t\t\t\t\tif(data.length==0) {\r\n\t\t\t\t\t\tme.hasNoLeftData = true;\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}else if(startX) {\r\n\t\t\t\t\tvar firstTime = data[0][0];\r\n\t\t\t\t\tif(firstTime == currDatas[currDatas.length-1]) {\r\n\t\t\t\t\t\tdata.shift();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif(!data.length) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif(isFormat!==false) {\r\n\t\t\t\tdata = me.formatDatas(data);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tcallbackFn&&callbackFn.call(me,data);\r\n\t\t\terror();\r\n\r\n\t\t}).fail(function(error){\r\n\t\t\tconsole.log(error)\r\n\t\t\tme.ajaxing = false;\r\n\t\t\tme.statusEle.html('请求数据失败');\r\n\t\t\tme.errorTimer&&clearTimeout(me.errorTimer);\r\n\t\t\tme.errorTimer = setTimeout(function(){\r\n\t\t\t\terror();\r\n\t\t\t},1000)\r\n\t\t\treturn false;\r\n\t\t})\r\n\r\n\t\tfunction error(){\r\n\t\t\tme.statusEle.html('');\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 跟据x轴的坐标获取对应数据的index和正确的x轴坐标,这里的对应数据是显示数据，不是总数据\r\n\t * @param  {[float]} x [x轴坐标，当然是相对值 ]\r\n\t * @return {[type]}   [description]\r\n\t */\r\n\t,adjustX: function(x){\r\n\t\tif(x > this.mainRegionWidth) {\r\n\t\t\tx = this.mainRegionWidth;\r\n\t\t}\r\n\t\tvar dataCount = this.showDatas.length;\r\n\t\tvar index = Math.ceil((dataCount)*x/this.mainRegionWidth);\r\n\t\tindex = index==0 ? 0 : index-1;\r\n\t\tvar xPos = core.getXByShowDataIndex(index,this.chartOpts.theme.barWidth,this.chartOpts.theme.spaceWidth);\r\n\t\treturn {index:index, x: xPos };\r\n\t}\r\n\t,getXByValue: function(value){\r\n\t\tvar showDatas = this.showDatas;\r\n\t\tvar data = [],max=0,min=0,index,xPos;\r\n\t\tfor(var i=0,len = showDatas.length;i<len;i++) {\r\n\t\t\tvar cur = showDatas[i];\r\n\t\t\tif(!cur) continue;\r\n\t\t\tif(cur.quoteTime==value) {\r\n\t\t\t\tindex = i;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif(index) {\r\n\t\t\txPos = core.getXByShowDataIndex(index,this.chartOpts.theme.barWidth,this.chartOpts.theme.spaceWidth);\r\n\t\t}\r\n\t\treturn {index:index,x:xPos}\r\n\t}\r\n\t,getYByValue: function(value,areaName,isTotal) {\r\n        var charOpts = this.chartOpts, opts = charOpts[areaName];\r\n        var high = opts.high,low  = opts.low,ret;\r\n        var value = parseFloat(value);\r\n        if(value >= low && value <=high) {\r\n            ret = core.getRelativeYByShowDataValue(value, high, low, opts.height);\r\n            var maxHeight = opts.height+0.5;\r\n            if(ret<= maxHeight) {\r\n\t\t\t\tif(isTotal) {\r\n\t                ret +=opts.y+opts.top;\r\n\t            }\r\n            }else {\r\n            \tret=null;\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\t/**\r\n\t * 根据传递的值，比较大小返回对应使用的颜色\r\n\t * @param  {[float]} referVal [需要对比的值]\r\n\t * @param  {[float]} target   [对比值]\r\n\t * @return {[string]}         [是riseColor还是fallColor]\r\n\t */\r\n\t,getColor: function(referVal,target){\r\n        var fallColor = this.chartOpts.theme.fallColor, riseColor = this.chartOpts.theme.riseColor, color='';\r\n        if(referVal > target) {\r\n            color = fallColor;\r\n        }else if(referVal < target) {\r\n            color = riseColor;\r\n        }\r\n        return color;\r\n    }\r\n\r\n\t/**\r\n\t * 改变title\r\n\t * @param {[type]} title [description]\r\n\t */\r\n\t,setTitle: function(title) {\r\n\t\tvar title = title,ret;\r\n\t\tif(typeof title=='string'){\r\n\t\t\tret = title;\r\n\t\t}else if(typeof title=='object') {\r\n\t\t\tif(!this.formatTitleTpl) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tret = this.formatTitleTpl(title);\r\n\t\t}\r\n\t\tthis.boxHeader.html(ret);\r\n\t}\r\n\r\n\t/**\r\n\t * 从时间得到此时间在数据集合里的index\r\n\t * @param  {[type]} time [时间]\r\n\t * @param  {[type]} dir  \r\n\t *         如果是向右拉，则是向左边请求值即请求时间较小的值，那么这时的dir是-1，反之为1。\r\n\t *         因为这个时间可能是datas里不是存在的，只能得到这个时间在数据集里最近在两个值的index，\r\n\t *         这个时候需要你要取左边的值还是右边的值\r\n\t * @return {[int]}      [在数据集里的index]\r\n\t */\r\n\t,getXIndexByTime: function(time,dir){\r\n\t\tvar datas = this.datas;\r\n\t\tvar upper = datas.length-1;\r\n\t\tvar lower = 0, mid;\r\n\t\tvar retIndex = -1;;\r\n\t\tvar min = datas[0].quoteTime, max = datas[upper].quoteTime;\r\n\t\tvar start = this.dataRanges.start, to = this.dataRanges.to;\r\n\t\t//当前显示的\r\n\t\tif(start >= lower){\r\n\t\t\tvar startMin = datas[start].quoteTime;\r\n\t\t\tif(time >=startMin) {\r\n\t\t\t\tlower = start;\r\n\t\t\t\tmin = startMin;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(to <= upper) {\r\n\t\t\tvar toMax = datas[to].quoteTime;\r\n\t\t\tif(time <=toMax) {\r\n\t\t\t\tupper = to;\r\n\t\t\t\tmax = toMax;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(time==min) {\r\n\t\t\tretIndex = lower;\r\n\t\t}else if(time==max) {\r\n\t\t\tretIndex = upper;\r\n\t\t}else  {\r\n\t\t\twhile(upper-lower>1) {\r\n\t\t\t\tmid = Math.floor((upper+lower)/2);\r\n\t\t\t\tif(datas[mid].quoteTime < time) {\r\n\t\t\t\t\tlower  = mid +1;\r\n\t\t\t\t}else if(datas[mid].quoteTime > time) {\r\n\t\t\t\t\tupper = mid -1;\r\n\t\t\t\t}else {\r\n\t\t\t\t\tretIndex = mid;\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif(retIndex==-1) {\r\n\t\t\t\tretIndex = dir ? upper : upper-1;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn retIndex;\r\n\t}\r\n\r\n\t/**\r\n\t * 使用ajax同步X轴\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t,synchronizeX: function(time,dir,barWidth,spaceWidth){\r\n\t\tvar minTime = this.datas[0].quoteTime, maxTime = this.datas[this.datas.length-1].quoteTime;\r\n\t\tvar me = this;\r\n\t\tif(typeof time=='object') {\r\n\t\t\tthis.painter(time,function(){\r\n\t\t\t\tme.autoLoadData();\r\n\t\t\t})\r\n\t\t}else if(time <minTime) {\r\n\t\t\t//指定时间比当前值小\r\n\t\t\tme.ajaxData(null,minTime,function(datas){\r\n\t\t\t\tif(datas.length) {\r\n\t\t\t\t\tme.appendDatas(datas,-1);\r\n\t\t\t\t\tme.synchronizeX(time,dir,barWidth,spaceWidth);\r\n\t\t\t\t}else {\r\n\t\t\t\t\tme.synchronizeX(minTime,dir,barWidth,spaceWidth);\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t}else if(time > maxTime) {\r\n\t\t\t//指定时间比当前值大,只能说真没有这个值了\r\n\t\t\tme.synchronizeX(maxTime,dir,barWidth,spaceWidth);\r\n\t\t}else {\r\n\t\t\tvar index = this.getXIndexByTime(time,dir);\r\n\t\t\tif(index!==-1) {\r\n\t\t\t\tif(barWidth) {\r\n\t\t\t\t\tthis.chartOpts.theme.barWidth = barWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif(spaceWidth){\r\n\t\t\t\t\tthis.chartOpts.theme.spaceWidth = spaceWidth;\r\n\t\t\t\t}\r\n\t\t\t\tif(barWidth||spaceWidth) {\r\n\t\t\t\t\tvar bWidth = this.chartOpts.theme.barWidth,sWidth = this.chartOpts.theme.spaceWidth;\r\n\t\t\t\t\tcount = Math.floor(this.mainRegionWidth/(bWidth+sWidth))-1;\r\n\t\t\t\t}else {\r\n\t\t\t\t\tcount = this.dataRanges.to - this.dataRanges.start;\r\n\t\t\t\t}\r\n\t\t\t\tvar start,to;\r\n\t\t\t\tif(dir) {\r\n\t\t\t\t\tto = index;\r\n\t\t\t\t\tstart = index - count;\r\n\t\t\t\t}else {\r\n\t\t\t\t\tstart = index;\r\n\t\t\t\t\tto = index + count;\r\n\t\t\t\t}\r\n\t\t\t\tthis.painter({start:start,to:to},function(){\r\n\t\t\t\t\tme.autoLoadData();\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t}\r\n\r\n\t/**\r\n\t * 重置数据\r\n\t * @param {Array} data [description]\r\n\t */\r\n\t,setDatas: function(datas){\r\n\t\tif(!datas) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.datas = datas;\r\n\t}\r\n\r\n\t/**\r\n\t * 当dom的width和height改变时调用\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t,resize: function(){\r\n\t\tif(!this.initComplete){return false;}\r\n\t\tvar width = this.container.width(),height = this.container.height();\r\n\t\tif(width==this.width&&height==this.height){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.width = this.container.width();\r\n\t\tthis.height = this.container.height();\r\n\t\tthis.computedSize();\r\n\t\tthis.wrap.css({width:this.width,height: this.height});\r\n\t\tthis.canvasBox.css({height:this.canvas.height,width:this.canvas.width});\r\n\t\tthis.eventsCanvas.width = this.canvas.width;\r\n\t\tthis.eventsCanvas.height = this.canvas.height;\r\n\t\t\r\n\t\tthis.zoom = true;\r\n\t\tthis.painter(null,null,true);\r\n\t\tfor(var area in this.tipList) {\r\n\t\t\tvar opts = this.chartOpts[area];\r\n\t\t\tthis.tipList[area].css('top',opts.y+2);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * 销毁\r\n\t * @return {[type]} [description]\r\n\t */\r\n\t,destroy: function(){\r\n\t\tthis.container.remove(this.wrap);\r\n\t}\r\n\r\n\t/**\r\n\t * 格式化数据\r\n\t * @param {Array} data [不符合格式的数据]\r\n\t * @return {[Array]} [description]\r\n\t */\r\n\t,formatDatas: function(data){\r\n\t\tvar result = [];\r\n\t    for (var i = 0; i < data.length; i++) {\r\n            //20111215,11.68,11.65,11.76,11.40,11.41,43356655,502325991\r\n            //日期,昨收,开盘价,高,低，收,量，额\r\n\t        var rawData = data[i];\r\n            if(rawData) {\r\n                var item = {\r\n                    quoteTime: rawData[0],\r\n                    preClose: rawData[1],\r\n                    open: rawData[2],\r\n                    high: rawData[3],\r\n                    low: rawData[4],\r\n                    close: rawData[5],\r\n                    volume: rawData[6],\r\n                    amount: rawData[7],\r\n                    avg: parseFloat(core.toMoney((rawData[3]+rawData[4])/2,5))\r\n                };\r\n                result.push(item);\r\n            }\r\n\t    }\r\n\t    var tempTimestamp = this.maxTimestamp||0;\r\n\t    this.maxTimestamp = Math.max(data[data.length-1][0],tempTimestamp);\r\n\t    return result;\r\n\t}\r\n}\r\n\r\nmodule.exports = Chartbox;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/ChartBox.js\n ** module id = 0\n ** module chunks = 0\n **/","module.exports = __WEBPACK_EXTERNAL_MODULE_1__;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** external {\"root\":\"jQuery\",\"commonjs\":\"jquery\",\"commonjs2\":\"jquery\",\"amd\":\"jquery\"}\n ** module id = 1\n ** module chunks = 0\n **/","\r\nif(!Array.prototype.indexOf) {\r\n    Array.prototype.indexOf = function (item, index) {\r\n        var n = this.length,\r\n                i = ~~index\r\n        if (i < 0)\r\n            i += n\r\n        for (; i < n; i++)\r\n            if (this[i] === item)\r\n                return i\r\n        return -1\r\n    }\r\n}\r\n\r\nmodule.exports = {\r\n\ttoMoney: function (number, decimals, point, thousands){\r\n        //form http://phpjs.org/functions/number_format/\r\n        //number    必需，要格式化的数字\r\n        //decimals  可选，规定多少个小数位。\r\n        //point 可选，规定用作小数点的字符串（默认为 . ）。\r\n        //thousands 可选，规定用作千位分隔符的字符串（默认为 , ），如果设置了该参数，那么所有其他参数都是必需的。\r\n        number = (number + '')\r\n                .replace(/[^0-9+\\-Ee.]/g, '')\r\n        var n = !isFinite(+number) ? 0 : +number,\r\n                prec = !isFinite(+decimals) ? 2 : Math.abs(decimals),\r\n                sep = thousands || \",\",\r\n                dec = point || \".\",\r\n                s = '',\r\n                toFixedFix = function(n, prec) {\r\n                    var k = Math.pow(10, prec)\r\n                    return '' + (Math.round(n * k) / k)\r\n                            .toFixed(prec)\r\n                }\r\n        // Fix for IE parseFloat(0.55).toFixed(0) = 0;\r\n        s = (prec ? toFixedFix(n, prec) : '' + Math.round(n))\r\n                .split('.')\r\n        if (s[0].length > 3) {\r\n            s[0] = s[0].replace(/\\B(?=(?:\\d{3})+(?!\\d))/g, sep)\r\n        }\r\n        if ((s[1] || '')\r\n                .length < prec) {\r\n            s[1] = s[1] || ''\r\n            s[1] += new Array(prec - s[1].length + 1)\r\n                    .join('0')\r\n        }\r\n        return s.join(dec)\r\n    },\r\n\tbigNumberToText: function (val) {\r\n        var result;\r\n        var yi = val / 100000000;\r\n        if (yi > 1) {\r\n            result = yi.toFixed(2) + '亿';\r\n        } else {\r\n            var wan = val / 10000;\r\n            if (wan > 1)\r\n                result = wan.toFixed(2) + '万';\r\n            else\r\n                result = val;\r\n        }\r\n        return result;\r\n    },\r\n    /**\r\n     * 日期转换函数\r\n     * @param  {[longer]} val    [时间戳]\r\n     * @param  {[int]} period [当前图显示的时间段1,5,30,60,100[1min,5min,30min,60min,1day]]\r\n     * @return {[type]}        [description]\r\n     */\r\n    convertDate: function(val,period,showYear){\r\n    \tvar time = '',ymd='',hour,minute,date = new Date(val);\r\n        if(period>=100) {\r\n            var year = date.getFullYear();\r\n            var month = date.getMonth()+1;\r\n            var day = date.getDate();\r\n            month = month<10 ? '0'+month: month;\r\n            day = day<10 ? '0'+day : day;\r\n            ymd = year + '-' + month + '-' + day;\r\n        }\r\n        if(showYear||period<100) {\r\n            var hour = date.getHours();\r\n            var minute = date.getMinutes();\r\n            hour = hour<10 ? '0'+hour : hour;\r\n            minute = minute<10 ? '0'+minute: minute;\r\n            time = hour +\":\" + minute;\r\n            if(ymd) {\r\n                time = ' '+time;\r\n            }\r\n        }\r\n        \r\n        return  ymd+time;\r\n    },\r\n    throttle: function(fn,delay) {\r\n        var timer = null;\r\n        var t_start;\r\n        delay = delay||200;\r\n\r\n        return function() {\r\n            var context = this,t_curr = +new Date();\r\n            if(!t_start) {\r\n                t_start = t_curr;\r\n            }\r\n            var args = arguments;\r\n            if(t_curr - t_start <delay) {\r\n                clearTimeout(timer);\r\n                timer = setTimeout(function(){\r\n                    fn.apply(context,args);\r\n                },delay)\r\n            }else {\r\n                fn.apply(context,args);\r\n                t_start = t_curr;\r\n            }\r\n            \r\n        }\r\n    },\r\n\r\n    objectCreate: function(){\r\n        if(Object.create) {\r\n            return Object.create;\r\n        }else {\r\n            return function(o){\r\n                \r\n            }\r\n        }\r\n        /*var F = function(){};\r\n        F.prototype = o;\r\n        return new F();*/\r\n    },\r\n\r\n    drawHLine: function (ctx,color, x0, y0, w, lineStyle) {\r\n        ctx.strokeStyle = color;\r\n        var dashSize = 3;\r\n        if (y0 * 10 % 10 == 0) y0 += .5;\r\n        if (lineStyle && lineStyle == 'dashed') {\r\n            var width = 0;\r\n            do {\r\n                this.drawHLine(ctx,color, width, y0, dashSize, 1, 'solid');\r\n                width += dashSize * 2;\r\n            } while (width < w);\r\n        }\r\n        else {\r\n            ctx.beginPath();\r\n            ctx.moveTo(x0, y0);\r\n            ctx.lineTo(x0 + w, y0);\r\n            ctx.stroke();\r\n        }\r\n    },\r\n    drawVLine: function (ctx,color, x0, y0, h, lineStyle) {\r\n        ctx.strokeStyle = color;\r\n        var dashSize = 3;\r\n        if (x0 * 10 % 10 == 0) x0 += .5;\r\n        if (lineStyle && lineStyle == 'dashed') {\r\n            var height = 0;\r\n            do {\r\n                this.drawVLine(ctx,color, x0, height, dashSize, 1);\r\n                height += dashSize * 2;\r\n            } while (height < h);\r\n        }\r\n        else {\r\n            ctx.beginPath();\r\n            ctx.moveTo(x0, y0);\r\n            ctx.lineTo(x0, y0 + h);\r\n            ctx.stroke();\r\n\r\n        }\r\n    },\r\n    getXByShowDataIndex: function(i, barWidth, spaceWidth) {\r\n        var result = i*(spaceWidth+barWidth) + barWidth*.5;\r\n        if(result*10%10==0) result +=.5;\r\n        return result;\r\n    },\r\n    getRelativeYByShowDataValue: function(value, high, low, height){\r\n        var result;\r\n        if(value==low){\r\n            result = height;\r\n        }else if(value==high) {\r\n            result = 0;\r\n        }else {\r\n            result = Math.ceil((high - value)*height/(high - low));\r\n        }\r\n        if (result * 10 % 10 == 0) result += .5;\r\n        return result;\r\n    }\r\n    \r\n}\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/common.js\n ** module id = 2\n ** module chunks = 0\n **/","/**\r\n * 蜡烛图\r\n * @type {[type]}\r\n */\r\nvar $ = require('jquery');\r\nvar core = require('./common.js');\r\nvar YAxisChart = require('./YAxisChart');\r\n\r\n\r\n\r\nvar Candlestick = function(areaName,chartBox){\r\n    if(!chartBox.showDatas) {\r\n        console.log('没有数据')\r\n        return false;\r\n    }\r\n    this.chartBox = chartBox;\r\n    this.name=\"Candlestick\";\r\n    this.ctx = chartBox.ctx;\r\n    this.areaName = areaName;\r\n    this.chartList = {};\r\n    this.init();\r\n}\r\nCandlestick.prototype = {\r\n    constructor: Candlestick,\r\n    init: function(){\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName];\r\n        if(opts.subCharts) {\r\n            var list = [];\r\n            for(var chart in opts.subCharts) {\r\n                var option = opts.subCharts[chart];\r\n                option.label = chart;\r\n                list.push(option);\r\n            }\r\n            list.sort(function(a,b){\r\n                return a.sort - b.sort;\r\n            })\r\n\r\n            for(var i=0,cur;cur=list[i++];) {\r\n                if(cur.show!==false) {\r\n                    var chartBox = this.chartBox;\r\n                    var chartObj = chartBox.chartObjFactory.call(chartBox,cur.type,this.areaName,cur.label);\r\n                    this.chartList[cur.label] = chartObj;\r\n                }\r\n            }\r\n        }\r\n\r\n\r\n\r\n        if(opts.yAxis) {\r\n            this.chartList['yAxis'] = new YAxisChart( this.ctx, this.chartBox.chartOpts.yAxis );\r\n        }\r\n    },\r\n\r\n    painter: function(){\r\n        var me  = this;\r\n        this.painting = true;\r\n        this.ctx.save();\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName], theme = charOpts.theme,height = opts.height, width = opts.width;\r\n        this.ctx.translate(opts.x,opts.y + opts.top);\r\n        //画水平底纹线\r\n        var spaceCount = Math.floor(height /(opts.horizontalLineSpace));\r\n        var spaceHeight = height / spaceCount;\r\n        var yPos = [];\r\n        for(var i=0; i<= spaceCount; i++) {\r\n            var y = Math.ceil(spaceHeight*i);\r\n            if (y * 10 % 10 == 0) y += .5;\r\n            yPos.push(y);\r\n            if(opts.bottom<=5&&i==spaceCount) {\r\n                continue;\r\n            }\r\n            core.drawHLine.call(core,this.ctx,theme.lineColor,0,y,width+opts.margin,'dashed');\r\n            \r\n        }\r\n\r\n        this.yPos = yPos;\r\n       \r\n        this.getDatasRegion();\r\n        for(var i in this.chartList) {\r\n            var chartObj = this.chartList[i];\r\n            chartObj.getDatasRegion();\r\n        }        \r\n       \r\n\r\n        //画蜡烛线图 \r\n        var datas = this.getDatas();\r\n        this.needCandleRect = !!(theme.barWidth > 1.5);\r\n        this.currentX = 0;\r\n        for(var i=0,len = datas.length; i<len;i++) {\r\n            if(!datas[i]) {\r\n                continue;\r\n            }\r\n            me.drawItem(datas[i],i)\r\n        }\r\n\r\n\r\n        this.drawYAxisChart();\r\n        this.ctx.restore();\r\n\r\n        //画主图的副图部分\r\n        for(var i in this.chartList) {\r\n            if(i=='yAxis') {\r\n                continue;\r\n            }\r\n            var chartObj = this.chartList[i];\r\n            chartObj.painter();\r\n        }\r\n\r\n        this.painting = false;\r\n    },\r\n\r\n    drawBackground: function(){\r\n        this.paintCount = this.paintCount||1;\r\n        if(this.paintCount>1) {\r\n            var charOpts = this.opts, opts = charOpts[this.areaName];\r\n            var y = opts.height+opts.top+opts.bottom;\r\n            this.ctx.clearRect(0,-opts.top,opts.width+opts.margin,y);\r\n        }\r\n        this.paintCount++;\r\n    },\r\n\r\n    drawItem: function(ki,i){\r\n        var me = this,ctx = this.ctx,charOpts = this.chartBox.chartOpts,opts = charOpts[this.areaName], theme = charOpts.theme, datas = this.getDatas(), high = opts.high, low = opts.low;\r\n        \r\n        var isRise = ki.close > ki.open;\r\n        var color = isRise ? theme.riseColor : theme.fallColor;\r\n\r\n        var lineX = core.getXByShowDataIndex(i,theme.barWidth,theme.spaceWidth);\r\n        //currentX？\r\n        if (!this.currentX) this.currentX = lineX;\r\n        else {\r\n            if (lineX - this.currentX < 1) return;\r\n        }\r\n        this.currentX = lineX;\r\n        var topY = core.getRelativeYByShowDataValue(ki.high, high, low, opts.height);\r\n        var bottomY = core.getRelativeYByShowDataValue(ki.low, high, low, opts.height); \r\n        if (me.needCandleRect) {\r\n           \r\n            \r\n            var candleY, candleHeight;\r\n            if (isRise) {\r\n                candleY = core.getRelativeYByShowDataValue(ki.close, high, low, opts.height);\r\n                candleHeight = core.getRelativeYByShowDataValue(ki.open, high, low, opts.height) - candleY;\r\n            } else {\r\n                candleY = core.getRelativeYByShowDataValue(ki.open, high, low, opts.height);\r\n                candleHeight = core.getRelativeYByShowDataValue(ki.close, high, low, opts.height) - candleY;\r\n            }\r\n\r\n            //candleHeight = candleHeight;\r\n\r\n            //中间的那条线\r\n            var candleX = lineX - theme.barWidth / 2;\r\n            /*ctx.beginPath();\r\n            ctx.moveTo(lineX, topY);\r\n            ctx.lineTo(lineX, bottomY);\r\n            ctx.stroke();*/\r\n\r\n            \r\n           /* ctx.beginPath();\r\n            ctx.fillRect(candleX, candleY, theme.barWidth, candleHeight);*/\r\n            this.drawCandle(isRise,lineX,topY,bottomY,[candleX,candleY,theme.barWidth,candleHeight]);\r\n\r\n        } else {\r\n            ctx.strokeStyle = color;\r\n            //画线\r\n            ctx.beginPath();\r\n            ctx.moveTo(lineX, topY);\r\n            ctx.lineTo(lineX, bottomY);\r\n            ctx.stroke();\r\n        }\r\n    },\r\n    drawCandle: function(isRise,x,highY,lowY,rect){\r\n        var me = this,ctx = this.ctx,charOpts = this.chartBox.chartOpts, theme = charOpts.theme\r\n        var color = isRise ? theme.riseColor : theme.fallColor;\r\n        ctx.strokeStyle = color;\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, highY);\r\n        ctx.lineTo(x, lowY);\r\n        ctx.stroke();\r\n        if(isRise) {\r\n            ctx.fillStyle = theme.backgroundColor;\r\n            ctx.beginPath();\r\n            ctx.fillRect.apply(ctx,rect);\r\n            ctx.strokeStyle = color;\r\n            ctx.beginPath();\r\n            ctx.strokeRect.apply(ctx,rect);\r\n        }else {\r\n            ctx.fillStyle = color;\r\n            ctx.beginPath();\r\n            ctx.fillRect.apply(ctx,rect);\r\n        }\r\n        \r\n    },\r\n\r\n    getDatas: function(){\r\n        return this.chartBox.showDatas;\r\n    },\r\n    //这里主要是算所属区域的最大值和最小值\r\n    getDatasRegion: function(){\r\n        this.chartBox.calcAreaDataValueRange.call(this.chartBox,this.areaName);\r\n        \r\n    },\r\n\r\n    drawYAxisChart: function(){\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName];\r\n        if(!this.chartList['yAxis']) {\r\n            return false;\r\n        }\r\n        var datas = this.getDatas(), high = opts.high, low = opts.low, yPos = this.yPos, height = opts.height;\r\n        \r\n        var result = [];\r\n        for(var i=0,len = yPos.length; i<len; i++) {\r\n            var val = high - (high-low)*yPos[i]/height;\r\n            var v = core.toMoney(val,opts.dotLen);\r\n            result.push({value:v,y:yPos[i]});\r\n        }\r\n        \r\n        this.chartList['yAxis'].painter(result,{x: opts.width+opts.margin,y:0, height:opts.height})\r\n    },\r\n\r\n    getValueByY: function(y) {\r\n        var chartOpts = this.chartBox.chartOpts, opts = chartOpts[this.areaName], datas = this.getDatas(), high = opts.high, low = opts.low;\r\n        var totalHeight = opts.top + opts.height + opts.bottom, dotLen = opts.dotLen, val;\r\n        var highest = high + (high-low)*opts.top/opts.height;\r\n        var lowest = low - (high-low)*opts.bottom/opts.height;\r\n        var val;\r\n        if(y>opts.y && y < totalHeight+opts.y) {\r\n            y = y - opts.y;\r\n            val = core.toMoney(highest - (highest - lowest)*y/totalHeight,dotLen);\r\n        }\r\n        return val;\r\n    },\r\n\r\n    \r\n\r\n    getTip: function(index,follow){\r\n        var datas = this.getDatas();\r\n        var data = datas[index],dotLen = this.chartBox.chartOpts[this.areaName].dotLen;\r\n\r\n        var time = core.convertDate(data['quoteTime'],100,true);\r\n        var openColor = this.chartBox.getColor(data.preClose, data.open), openValue  = core.toMoney(data.open,dotLen);\r\n        var highColor = this.chartBox.getColor(data.preClose, data.high), highValue = core.toMoney(data.high,dotLen);\r\n        var lowColor = this.chartBox.getColor(data.preClose, data.low), lowValue = core.toMoney(data.low, dotLen);\r\n        var closeColor = this.chartBox.getColor(data.preClose, data.close),closeValue = core.toMoney(data.close, dotLen);\r\n        var ret = '';\r\n        if(follow){\r\n            ret = '<span>'+time+'</span>'+\r\n               '<span>开盘价:<em style=\"color:'+ openColor +'\">'+ openValue +'</em></span>'+\r\n               '<span>最高价:<em style=\"color:'+ highColor +'\">'+ highValue +'</em></span>'+\r\n               '<span>最低价:<em style=\"color:'+ lowColor +'\">'+ lowValue +'</em></span>'+\r\n               '<span>收盘价:<em style=\"color:'+ closeColor +'\">'+ closeValue +'</em></span>'\r\n        }else {\r\n            ret = '<span>日期:'+time+'</span>'+\r\n               '<span>开:<em style=\"color:'+ openColor +'\">'+ openValue +'</em></span>'+\r\n               '<span>高:<em style=\"color:'+ highColor +'\">'+ highValue +'</em></span>'+\r\n               '<span>低:<em style=\"color:'+ lowColor +'\">'+ lowValue +'</em></span>'+\r\n               '<span>收:<em style=\"color:'+ closeColor +'\">'+ closeValue +'</em></span>';\r\n            for(chart in this.chartList) {\r\n                var curChart = this.chartList[chart];\r\n                if(curChart.getTip) {\r\n                    ret +=curChart.getTip(index,follow);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n        \r\n    },\r\n\r\n}\r\nmodule.exports = Candlestick;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/CandlestickChart.js\n ** module id = 3\n ** module chunks = 0\n **/","/**\r\n * y轴\r\n * @type {[type]}\r\n */\r\nvar core = require('./common.js');\r\n\r\nfunction YAxisChart(ctx, opts){\r\n\tthis.ctx = ctx;\r\n\tthis.opts = opts;\r\n}\r\n\r\nYAxisChart.prototype = {\r\n\tconstructor: YAxisChart,\r\n\tpainter: function(datas,pos) {\r\n\t\tvar ctx = this.ctx,opts = this.opts;\r\n\t\tctx.save();\r\n\t\tctx.translate(pos.x,pos.y);\r\n\t\tctx.fillStyle = opts.color;\r\n\t\tctx.font = opts.font;\r\n\t\tvar height = pos.height;\r\n\t\tfor(var j=0,cur;cur = datas[j++];) {\r\n\t\t\tvar lineWidth = 5;\r\n\t\t\tcore.drawHLine.call(core,this.ctx, opts.lineColor, 0, cur.y, lineWidth, 'solid');\r\n\t\t\tvar y = cur.y + 3;\r\n\t\t\tif(y> height) {\r\n\t\t\t\ty = height -2;\r\n\t\t\t}\r\n\t\t\tctx.fillText(cur.value,lineWidth+2,y);\r\n\t\t}\r\n\r\n\t\tctx.restore();\r\n\r\n\t},\r\n\r\n\tgetDatasRegion:function(){\r\n\t\t\r\n\t}\r\n\t\r\n}\r\n\r\nmodule.exports = YAxisChart;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/YAxisChart.js\n ** module id = 4\n ** module chunks = 0\n **/","/**\r\n * 画交易额\r\n */\r\n\r\nvar core = require('./common.js');\r\n\r\nfunction VolumeChart(areaName,chartBox){\r\n\tif(!chartBox.showDatas) {\r\n        console.log('没有数据')\r\n        return false;\r\n    }\r\n    this.chartBox = chartBox;\r\n    this.name=\"VolumeChart\";\r\n    this.ctx = chartBox.ctx;\r\n    this.areaName = areaName;\r\n\tthis.init();\r\n}\r\n\r\nVolumeChart.prototype = {\r\n\tconstructor: VolumeChart,\r\n\tinit: function(){},\r\n\r\n\tpainter: function(){\r\n\t\tthis.painting = true;\r\n\t\t\r\n        this.ctx.save();\r\n        var chartOpts = this.chartBox.chartOpts,opts = chartOpts[this.areaName], theme = chartOpts.theme,height = opts.height, width = opts.width;\r\n        this.ctx.translate(opts.x,opts.y + opts.top);\r\n\r\n        //画水平底纹线\r\n        var spaceCount = Math.floor(height /(opts.horizontalLineSpace));\r\n        var spaceHeight = height / spaceCount;\r\n        var yPos = [];\r\n        for(var i=0; i<= spaceCount; i++) {\r\n            var y = Math.ceil(spaceHeight*i);\r\n            if (y * 10 % 10 == 0) y += .5;\r\n            yPos.push(y);\r\n            if(opts.bottom<=5&&i==spaceCount) {\r\n                continue;\r\n            }\r\n            core.drawHLine.call(core,this.ctx,opts.lineColor,0,y,width+opts.margin,'dashed');\r\n        }\r\n        this.yPos = yPos;\r\n\r\n        //画交易量图\r\n        this.getDatasRegion();\r\n        var datas = this.getDatas(), high = this.high;\r\n        i=0;\r\n        for(var i=0,len = datas.length; i<len;i++) {\r\n        \tif(!datas[i]) {\r\n        \t\tcontinue;\r\n        \t}\r\n            this.drawItem(datas[i],i)\r\n        }\r\n        this.ctx.restore();\r\n        this.painting = false;\r\n\t},\r\n\tdrawBackground: function(){\r\n\t\tthis.paintCount = this.paintCount||1;\r\n\t\tif(this.paintCount>1) {\t\t\t\r\n\t\t\tvar charOpts = this.opts, opts = charOpts[this.areaName];\r\n\t\t\tvar y = opts.height+opts.top+opts.bottom;\r\n\t\t\tthis.ctx.clearRect(0,-opts.top,opts.width+opts.margin,y);\r\n\t\t}\r\n\t\tthis.paintCount++;\r\n\t},\r\n\r\n\tgetDatas: function(){\r\n\t\treturn this.chartBox.showDatas;\r\n\t},\r\n\r\n    getDatasRegion: function(){\r\n        var datas = this.getDatas();\r\n        var maxVolume = 0;\r\n        for(var i=0,len=datas.length;i<len;i++) {\r\n            if(!datas[i]) {\r\n                continue;\r\n            }\r\n            maxVolume = Math.max(maxVolume,datas[i].volume);\r\n        }\r\n        this.chartBox.chartOpts[this.areaName].high = maxVolume;\r\n        this.chartBox.chartOpts[this.areaName].low = 0;\r\n        this.chartBox.chartOpts[this.areaName].dotLen =  2;\r\n    },\r\n\r\n\tdrawItem: function(ki,i){\r\n\t\tvar me = this,ctx = this.ctx,chartOpts = this.chartBox.chartOpts,areaOpts = chartOpts[this.areaName], theme = chartOpts.theme, high = areaOpts.high, low = areaOpts.low;\r\n        var isRise = ki.close > ki.open;\r\n        var color = isRise ? theme.riseColor : theme.fallColor;\r\n        var lineX = core.getXByShowDataIndex(i,theme.barWidth,theme.spaceWidth);\r\n        ctx.fillStyle = color;\r\n        var height = core.getRelativeYByShowDataValue(ki.volume, high, low, areaOpts.height);\r\n        ctx.beginPath();\r\n        var barHeight  = Math.max((areaOpts.height - height),2)\r\n        var x = lineX - theme.barWidth/2\r\n        ctx.rect(x, height, theme.barWidth, areaOpts.height-height);\r\n        //ctx.strokeStyle = color;\r\n        ctx.fill();\r\n       /* ctx.beginPath();\r\n        ctx.moveTo(lineX, height);\r\n        ctx.lineTo(lineX, areaOpts.height);\r\n        ctx.stroke();*/\r\n\r\n\t},\r\n    getValueByY: function(y) {\r\n        var chartOpts = this.chartBox.chartOpts, opts = chartOpts[this.areaName], datas = this.getDatas(), high = opts.high, low = opts.low;\r\n        var totalHeight = opts.top + opts.height + opts.bottom, dotLen=2, val;\r\n        var highest = high + (high-low)*opts.top/opts.height;\r\n        var val;\r\n        if(y>opts.y && y < totalHeight+opts.y) {\r\n            y = y - opts.y\r\n            val = core.toMoney(highest - (highest)*y/totalHeight,dotLen);\r\n        }\r\n        return val;\r\n    },\r\n    getTip: function(index,follow){\r\n        var datas = this.getDatas();\r\n        var data = datas[index],dotLen = this.chartBox.dotLen;\r\n        var volume = core.bigNumberToText(data['volume']);\r\n        var amount = core.bigNumberToText(data['amount']);\r\n        var color = this.chartBox.getColor(data.close,data.open);\r\n        if(follow) {\r\n            return '<span>成交量:<em style=\"color:'+ color +'\">'+ volume +'</em>手</span>'+\r\n                '<span>成交额:<em style=\"color:'+ color +'\">'+ data['amount'] +'</em></span>'\r\n        }else {\r\n            return '<span>量:<em style=\"color:'+ color +'\">'+ volume +'</em></span>'+\r\n                '<span>额:<em style=\"color:'+ color +'\">'+ data['amount'] +'</em></span>';\r\n        }\r\n        \r\n\r\n    }\r\n}\r\n\r\nmodule.exports = VolumeChart;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/VolumeChart.js\n ** module id = 5\n ** module chunks = 0\n **/","/**\r\n * x轴\r\n */\r\nvar core = require('./common.js');\r\n\r\nfunction XAixsChart(areaName,chartBox){\r\n\tif(!chartBox.showDatas) {\r\n        console.log('没有数据')\r\n        return false;\r\n    }\r\n    this.chartBox = chartBox;\r\n    this.name=\"XAixsChart\";\r\n    this.ctx = chartBox.ctx;\r\n    this.areaName = areaName;\r\n\tthis.init();\r\n}\r\nXAixsChart.prototype = {\r\n\tconstrucotor: XAixsChart,\r\n\r\n\tinit: function(){},\r\n\r\n\tpainter: function(){\r\n\t\tthis.painting = true;\r\n        this.ctx.save();\r\n\r\n        var chartOpts = this.chartBox.chartOpts,opts = chartOpts[this.areaName],theme = chartOpts.theme,height = opts.height, width = opts.width;\r\n        this.ctx.translate(opts.x,opts.y + opts.top);\r\n       \r\n\r\n        //计算间隔\r\n\t\tvar xWidth = opts.verticalLineSpace,barWidth = theme.barWidth,spaceWidth = theme.spaceWidth;\r\n\t\tvar pie = Math.ceil(xWidth/(barWidth+spaceWidth));\r\n\t\tthis.space = (barWidth+spaceWidth)*pie;\r\n\r\n\t\t\r\n\t\tvar datas = this.getDatas();\r\n\t\tvar xDatas = []\r\n\t\tfor(var i=datas.length-1; i>=0; i-=pie) {\r\n\t\t\tvar x = core.getXByShowDataIndex(i,theme.barWidth,theme.spaceWidth),value;\r\n\t\t\tif(datas[i]) {\r\n\t\t\t\tvalue = core.convertDate(datas[i].quoteTime,chartOpts.period);\r\n\t\t\t\txDatas.push({value:value,x:x});\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\r\n\t\tvar y = 0 ;\r\n\r\n\t\tfor(var j=0,cur;cur = xDatas[j++];) {\r\n\t\t\tcore.drawVLine(this.ctx, opts.lineColor, cur.x, y, 5, 'solid');\r\n\t\t}\r\n\r\n\t\tthis.drawTexts(xDatas);\r\n\t\tthis.ctx.restore();\r\n        this.painting = false;\r\n\t},\r\n\tdrawBackground: function(){\r\n\t\tthis.paintCount = this.paintCount||1;\r\n\t\tif(this.paintCount>1) {\r\n\t\t\tvar charOpts = this.opts, opts = charOpts[this.areaName];\r\n\t\t\tvar y = opts.height+opts.top+opts.bottom;\r\n\t\t\tthis.ctx.clearRect(0,-opts.top,opts.width+opts.margin,y);\r\n\t\t}\r\n\t\tthis.paintCount++;\r\n\t},\r\n\tgetDatas: function(){\r\n\t\treturn this.chartBox.showDatas;\r\n\t},\r\n\tdrawTexts: function(datas){\r\n\t\tvar ctx = this.ctx, opts =this.chartBox.chartOpts[this.areaName];\r\n\t\tctx.fillStyle = opts.color;\r\n\t\tctx.font = opts.font;\r\n\t\tfor(var j=0,cur;cur = datas[j++];) {\r\n\t\t\tif(cur.value) {\r\n\t\t\t\tvar w = ctx.measureText(cur.value).width;\r\n\t\t\t\tvar x = Math.max(cur.x - w/2,0);\r\n\t\t\t\tctx.fillText(cur.value,x,20);\r\n\t\t\t}\r\n\t\t}\r\n\t},\t\r\n}\r\n\r\nmodule.exports = XAixsChart;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/XAxisChart.js\n ** module id = 6\n ** module chunks = 0\n **/","/**\r\n * 画折线（分时图）\r\n */\r\n\r\nvar $ = require('jquery');\r\nvar core = require('./common.js');\r\nvar YAxisChart = require('./YAxisChart');\r\n\r\nfunction Polyline(areaName,chartBox){\r\n\tif(!chartBox.showDatas) {\r\n        console.log('没有数据')\r\n        return false;\r\n    }\r\n    this.chartBox = chartBox;\r\n    this.name=\"Polyline\";\r\n    this.ctx = chartBox.ctx;\r\n    this.areaName = areaName;\r\n    this.chartList = {};\r\n\tthis.init();\r\n}\r\n\r\nPolyline.prototype = {\r\n    constructor: Polyline,\r\n    init: function(){\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName];\r\n        if(opts.yAxis) {\r\n            this.chartList['yAxis'] = new YAxisChart( this.ctx, this.chartBox.chartOpts.yAxis );\r\n        }\r\n    },\r\n    painter: function(){\r\n        var me  = this,ctx = this.ctx;\r\n        this.painting = true;\r\n        ctx.save();\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName], theme = charOpts.theme, height = opts.height, width = opts.width;\r\n        ctx.translate(opts.x,opts.y + opts.top);\r\n        //画水平底纹线\r\n        var spaceCount = Math.floor(height /(opts.horizontalLineSpace));\r\n        var spaceHeight = height / spaceCount;\r\n        var yPos = [];\r\n        for(var i=0; i<= spaceCount; i++) {\r\n            var y = Math.ceil(spaceHeight*i);\r\n            if (y * 10 % 10 == 0) y += .5;\r\n            \r\n            core.drawHLine.call(core,this.ctx,theme.lineColor,0,y,width+opts.margin,'dashed');\r\n            yPos.push(y);\r\n        }\r\n\r\n        this.yPos = yPos;\r\n\r\n        this.getDatasRegion();\r\n        //画折线图 \r\n        var datas = this.getDatas(),high = opts.high,low = opts.low;\r\n        \r\n        ctx.strokeStyle = opts.opts&&opts.opts.lineColor||theme.lineColor;\r\n        ctx.beginPath();\r\n        var moveTo = false\r\n        for(var i=0,len = datas.length; i<len;i++) {\r\n            if(!datas[i]) {\r\n                continue;\r\n            }\r\n            var y = core.getRelativeYByShowDataValue(datas[i]['avg'], high, low, opts.height);\r\n            var x = core.getXByShowDataIndex(i,theme.barWidth,theme.spaceWidth);\r\n            if(!moveTo) {\r\n                ctx.moveTo(x,y);\r\n                moveTo = true;\r\n            }else {\r\n                ctx.lineTo(x,y);\r\n            }\r\n            \r\n        }\r\n        \r\n        ctx.stroke();\r\n        this.drawYAxisChart();\r\n        ctx.restore();\r\n        this.painting = false;\r\n    },\r\n\r\n    drawBackground: function(){\r\n\r\n    },\r\n\r\n    getDatas: function(){\r\n        return this.chartBox.showDatas;\r\n    },\r\n\r\n    //这里主要是算所属区域的最大值和最小值\r\n    getDatasRegion: function(){\r\n        this.chartBox.calcAreaDataValueRange.call(this.chartBox,this.areaName);\r\n    },\r\n\r\n    drawYAxisChart: function(){\r\n        var charOpts = this.chartBox.chartOpts, opts = charOpts[this.areaName];\r\n        if(!this.chartList['yAxis']) {\r\n            return false;\r\n        }\r\n        var datas = this.getDatas(), high = opts.high, low = opts.low, yPos = this.yPos,height = opts.height;\r\n        var result = [];\r\n        for(var i=0,len = yPos.length; i<len; i++) {\r\n            var val = high - (high-low)*yPos[i]/height;\r\n            var v = core.toMoney(val,opts.dotLen);\r\n            result.push({value:v,y:yPos[i]});\r\n        }\r\n        \r\n        this.chartList['yAxis'].painter(result,{x: opts.width+opts.margin,y:0, height:opts.height})\r\n    },\r\n\r\n    getValueByY: function(y) {\r\n        var chartOpts = this.chartBox.chartOpts, opts = chartOpts[this.areaName], datas = this.getDatas(), high = opts.high, low = opts.low;\r\n\r\n        var totalHeight = opts.top + opts.height + opts.bottom, dotLen = opts.dotLen, val;\r\n        var highest = high + (high-low)*opts.top/opts.height;\r\n        var lowest = low - (high-low)*opts.bottom/opts.height;\r\n        var val;\r\n        if(y>opts.y && y < totalHeight+opts.y) {\r\n            y = y - opts.y;\r\n            val = core.toMoney(highest - (highest - lowest)*y/totalHeight,dotLen);\r\n        }\r\n        return val;\r\n        \r\n    },\r\n\r\n    getTip: function(index,follow){\r\n        var datas = this.getDatas();\r\n        var data = datas[index],dotLen = this.chartBox.chartOpts[this.areaName].dotLen;\r\n\r\n        var time = core.convertDate(data['quoteTime'],100,true);\r\n        var openColor = this.chartBox.getColor(data.preClose, data.open), openValue  = core.toMoney(data.open,dotLen);\r\n        var highColor = this.chartBox.getColor(data.preClose, data.high), highValue = core.toMoney(data.high,dotLen);\r\n        var lowColor = this.chartBox.getColor(data.preClose, data.low), lowValue = core.toMoney(data.low, dotLen);\r\n        var closeColor = this.chartBox.getColor(data.preClose, data.close),closeValue = core.toMoney(data.close, dotLen);\r\n        var ret = '';\r\n        if(follow){\r\n            ret = '<span>'+time+'</span>'+\r\n               '<span>开盘价:<em style=\"color:'+ openColor +'\">'+ openValue +'</em></span>'+\r\n               '<span>最高价:<em style=\"color:'+ highColor +'\">'+ highValue +'</em></span>'+\r\n               '<span>最低价:<em style=\"color:'+ lowColor +'\">'+ lowValue +'</em></span>'+\r\n               '<span>收盘价:<em style=\"color:'+ closeColor +'\">'+ closeValue +'</em></span>'\r\n        }else {\r\n            ret = '<span>日期:'+time+'</span>'+\r\n               '<span>开:<em style=\"color:'+ openColor +'\">'+ openValue +'</em></span>'+\r\n               '<span>高:<em style=\"color:'+ highColor +'\">'+ highValue +'</em></span>'+\r\n               '<span>低:<em style=\"color:'+ lowColor +'\">'+ lowValue +'</em></span>'+\r\n               '<span>收:<em style=\"color:'+ closeColor +'\">'+ closeValue +'</em></span>'\r\n        }\r\n        return ret;\r\n        \r\n    }\r\n}\r\n\r\nmodule.exports = Polyline;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/PolylineChart.js\n ** module id = 7\n ** module chunks = 0\n **/","/**\r\n * 空心蜡烛图\r\n */\r\nvar core = require('./common');\r\nvar Candle = require('./CandlestickChart.js');\r\n\r\nfunction HollowCandle(areaName,chartBox){\r\n\tCandle.apply(this,arguments);\r\n}\r\n\r\nvar objectCreate = core.objectCreate();\r\nHollowCandle.prototype = objectCreate(Candle.prototype);\r\nHollowCandle.prototype.constructor = HollowCandle;\r\n\r\nHollowCandle.prototype.drawCandle = function(isRise,x,highY,lowY,rect){    \r\n    var me = this,ctx = this.ctx,charOpts = this.chartBox.chartOpts, theme = charOpts.theme\r\n        var color = isRise ? theme.riseColor : theme.fallColor;\r\n        ctx.strokeStyle = color;\r\n        ctx.beginPath();\r\n        ctx.moveTo(x, highY);\r\n        ctx.lineTo(x, lowY);\r\n        ctx.stroke();\r\n        ctx.fillStyle = theme.backgroundColor;\r\n        ctx.beginPath();\r\n        ctx.fillRect.apply(ctx,rect);\r\n        ctx.strokeStyle = color;\r\n        ctx.beginPath();\r\n        ctx.strokeRect.apply(ctx,rect);\r\n\r\n}\r\n\r\n\r\n\r\nmodule.exports = HollowCandle;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/HollowCandleChart.js\n ** module id = 8\n ** module chunks = 0\n **/","/**\r\n * 画月线\r\n * @param {[type]} ctx  [description]\r\n * @param {[type]} data [description]\r\n */\r\n\r\nvar core = require('./common.js');\r\nfunction MAChart(areaName,chartBox,id){\r\n    if(!chartBox.showDatas) {\r\n        console.log('没有数据')\r\n        return false;\r\n    }\r\n    this.chartBox = chartBox;\r\n    this.name=\"MAChart\";\r\n    this.areaName = areaName;\r\n    this.ctx = chartBox.ctx;\r\n    this.id = id;\r\n    this.init();\r\n}\r\n\r\nMAChart.prototype = {\r\n    construcotor: MAChart,\r\n    init: function(){},\r\n    painter: function(){\r\n        this.painting = true;\r\n        this.ctx.save();\r\n\r\n        var ctx = this.ctx, chartBox = this.chartBox, chartOpts = chartBox.chartOpts, areaOpts = chartOpts[this.areaName], theme = chartOpts.theme,height = areaOpts.height;\r\n        \r\n        var opts = !this.id ? areaOpts['opts']: areaOpts['subCharts'][this.id];\r\n        if(!this.id) {\r\n            this.getDatasRegion();\r\n        }\r\n\r\n        this.ctx.translate(areaOpts.x, areaOpts.top);\r\n        \r\n        var high = areaOpts.high, low = areaOpts.low, datas = this.getDatas();\r\n        ctx.strokeStyle = opts.color;\r\n        ctx.beginPath();\r\n        for(var j=0,jl = datas.length;j<jl;j++) {\r\n            var v = datas[j];\r\n            if(!v) continue ;\r\n            var x = core.getXByShowDataIndex(j,theme.barWidth,theme.spaceWidth),\r\n                y = core.getRelativeYByShowDataValue(v,high,low,height);\r\n\r\n            if(y&&j==0) {\r\n                ctx.moveTo(x,y);\r\n            }else {\r\n                ctx.lineTo(x,y);\r\n            }\r\n        }\r\n        ctx.stroke();\r\n        ctx.closePath();\r\n\r\n        this.ctx.restore();\r\n        this.painting = false;\r\n        \r\n    },\r\n\r\n    drawBackground: function(){\r\n        this.paintCount = this.paintCount||1;\r\n        if(this.paintCount>1) {\r\n            var charOpts = this.opts, opts = charOpts[this.areaName];\r\n            var height = opts.height,y = opts.y;\r\n            if(this.isSubItem) {\r\n                height = this.canvas.height;\r\n                y = 0;\r\n            }\r\n            this.ctx.clearRect(0,y,opts.width+opts.margin,height);\r\n        }\r\n        this.paintCount++;\r\n    },\r\n\r\n    getDatas: function(calc){\r\n        if(!calc) {\r\n            return this.datas;\r\n        }\r\n        var chartBox = this.chartBox, chartOpts = chartBox.chartOpts, areaOpts = chartOpts[this.areaName]\r\n        var opts = !this.id ? areaOpts['opts']: areaOpts['subCharts'][this.id];\r\n        if(!opts.daysCount) {\r\n            throw new Error('没有设置移动平均线的日期间隔');\r\n            return false\r\n        }\r\n\r\n        var datas = this.calcMAPrices(opts.daysCount);\r\n        this.preAvg = datas.shift();\r\n        this.datas = datas;\r\n        return datas;\r\n    },\r\n\r\n    getDatasRegion: function(){\r\n        var datas = this.getDatas(true);\r\n        var areaName  = this.areaName;\r\n        var opts = this.chartBox.chartOpts[areaName];\r\n        var high = opts.high,low = opts.low;\r\n        var tempDatas = [];\r\n        for(var i=0,len = datas.length;i<len;i++) {\r\n            if(datas[i]) {\r\n                tempDatas.push(datas[i]);\r\n            }\r\n        }\r\n        if(high) {\r\n            tempDatas.push(high);\r\n        }\r\n        high = Math.max.apply(null,tempDatas);\r\n\r\n        if(low) {\r\n            tempDatas.push(low);\r\n        }\r\n        low = Math.min.apply(null,tempDatas);\r\n\r\n        this.chartBox.chartOpts[areaName].high = high;\r\n        this.chartBox.chartOpts[areaName].low = low;\r\n\r\n    },\r\n\r\n    calcMAPrices: function(daysCn){\r\n        var chartBox = this.chartBox, dataRanges = chartBox.dataRanges, datas = chartBox.datas;\r\n        var startIndex = dataRanges.start;\r\n        var result = [];\r\n        for(var i = startIndex-1; i<= dataRanges.to; i++) {            \r\n            if( i<0 || i>datas.length-1) {\r\n                result.push(false);\r\n                continue;\r\n            }\r\n            var startCalcIndex = i - daysCn +1;\r\n            if(startCalcIndex < 0) {\r\n                result.push(datas[i].close);\r\n                continue;\r\n            }\r\n            var sum = 0;\r\n            for(var k = startCalcIndex; k <= i; k++) {\r\n                sum += datas[k].close;\r\n            }\r\n            var val = sum/daysCn;\r\n            \r\n            result.push(val);\r\n        }\r\n        \r\n        return result;\r\n    },\r\n\r\n    getTip: function(index,follow) {\r\n        var opts = this.chartBox.chartOpts[this.areaName],dotLen = opts.dotLen;\r\n        var datas = this.datas;\r\n\r\n        var chartBox = this.chartBox, chartOpts = chartBox.chartOpts, areaOpts = chartOpts[this.areaName]\r\n        var opts = !this.id ? areaOpts['opts']: areaOpts['subCharts'][this.id];\r\n        if(follow) {\r\n            return '';\r\n        }\r\n        var val = datas[index];\r\n        var prevVal = index==0 ? this.preAvg : datas[index-1];\r\n        var color = this.chartBox.getColor(prevVal,val);\r\n        val = core.toMoney(val,dotLen);\r\n        return '<span style=\"color:'+opts.color+'\">MA'+opts.daysCount+':<em style=\"color:'+ color +'\">' + val + '</em></span>';       \r\n    }\r\n\r\n}\r\n\r\nmodule.exports = MAChart;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/MAChart.js\n ** module id = 9\n ** module chunks = 0\n **/","/**\r\n * 拖拽事件\r\n */\r\n\r\nvar core = require('./common.js');\r\nvar $ = require('jquery');\r\n\r\nfunction DragEvent(canvas,chartBox){\r\n\tthis.canvas = canvas;\r\n\tthis.ctx = canvas.getContext('2d');\r\n\tthis.chartBox = chartBox;\r\n\r\n\tthis.init();\r\n}\r\nvar i=0;\r\nDragEvent.prototype = {\r\n\tconstrucor: DragEvent,\r\n\tinit: function(){\r\n\t\tvar me = this;\r\n\t\t$(me.canvas).on('mousedown.drag',function(e){\r\n\t\t\tif(window.mouseMoveLocked) return ;\r\n\t\t\tif(!e.button) {\r\n\t\t\t\tme.start(e);\r\n\t\t\t}else {\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}).on('mousemove.drag',function(e){\r\n\t\t\tme.move(e);\r\n\t\t}).on('mouseup.drag', function(e){\r\n\t\t\tif(window.mouseMoveLocked) return ;\r\n\t\t\tme.end.call(me,e);\r\n\t\t}).on('mouseleave',function(e){\r\n\t\t\tif(window.mouseMoveLocked) return ;\r\n\t\t\tme.end.call(me,e);\r\n\t\t})\r\n\t},\r\n\tstart: function(e){\r\n\t\t$(this.canvas).addClass('cur-drag');\r\n\t\tvar point = {\r\n\t\t\tx: e.pageX,\r\n\t\t\ty: e.pageY\r\n\t\t}\r\n\t\tvar dragOpts = this.chartBox.events.drag||{};\r\n\t\tvar canDrag = dragOpts.onBeforeDrag&&dragOpts.onBeforeDrag.call(this.chartBox);\r\n\t\tif(canDrag===false) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tthis.startPoint = point;\r\n\t\tthis.dataRanges = this.chartBox.dataRanges;\r\n\t\tthis.chartBox.dragging = true;\r\n\t\tif(this.canvas.clear) {\r\n\t\t\tthis.ctx.clearRect(0, 0 ,this.canvas.width, this.canvas.height);\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t},\r\n\r\n\tmove: function(e){\r\n\t\tvar chartBox = this.chartBox;\r\n\t\tif(!this.startPoint){\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t\r\n\t\t\r\n\t\tvar dataRanges = this.dataRanges, startPoint = this.startPoint, dataLength = chartBox.showDatas.length;\r\n\t\tvar moveX = e.pageX - startPoint.x;\r\n\t\tvar dataCount = Math.floor(moveX*dataLength/chartBox.mainRegionWidth);\r\n\t\t\r\n\t\tif(dataCount!=0) { \r\n\t\t\tthis.canExecEnd = true;\r\n\t\t\tvar dragOpts = chartBox.events.drag||{};\r\n\t\t\tvar start  = dataRanges.start - dataCount,to = dataRanges.to - dataCount;\r\n\t\t\tvar newDataRanges = {start: start, to : to};\r\n\t\t\tthis.chartBox.painter(newDataRanges);\r\n\t\t\tdragOpts.onDrag&&dragOpts.onDrag.call(chartBox,dataRanges);\r\n\t\t\t\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t\t\r\n\t},\r\n\tend: function(e){\r\n\t\tthis.startPoint = null;\r\n\t\tthis.dataRanges = null;\r\n\t\t$(this.canvas).removeClass('cur-drag');\r\n\t\tthis.chartBox.dragging = false;\r\n\t\tif(this.canExecEnd){\r\n\t\t\tvar ev;\r\n\t\t\tif(ev = this.chartBox.events.drag.onAfterDrag) {\r\n\t\t\t\tev.call(this.chartBox);\r\n\t\t\t}\r\n\t\t\tif(this.chartBox.dataRanges) {\r\n\t\t\t\tthis.chartBox.autoLoadData();\r\n\t\t\t}\r\n\t\t\tthis.canExecEnd = false;\r\n\t\t}\r\n\t\te.stopPropagation();\r\n\t}\r\n}\r\n\r\nmodule.exports = DragEvent;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/DragEvent.js\n ** module id = 10\n ** module chunks = 0\n **/","/**\r\n * 鼠标滚动事件\r\n */\r\n\r\nvar $ = jQuery = require('jquery');\r\n\r\nrequire('./vendor/jquery.mousewheel.min');\r\n\r\nfunction WheelEvent(canvas,chartBox){\r\n\tthis.canvas = canvas;\r\n\tthis.ctx = canvas.getContext('2d');\r\n\tthis.chartBox = chartBox;\r\n\tthis.init();\r\n}\r\n\r\nWheelEvent.prototype = {\r\n\tconstructor: WheelEvent,\r\n\tinit: function(){\r\n\t\tvar me = this;\r\n\t\t$(this.canvas).on('mousewheel',function(e){\r\n\t\t\tme.wheel.call(me,e);\r\n\t\t})\r\n\t},\r\n\twheel: function(e){\r\n\t\tvar chartBox = this.chartBox, dataRanges = chartBox.dataRanges, chartOpts = chartBox.chartOpts, theme = chartOpts.theme;\r\n\t\tvar wheelOpts = chartBox.events.wheel;\r\n\t\tvar step = wheelOpts.step||6;\r\n\t\tvar itemCount = chartBox.showDatas.length;\r\n\t\tvar changeCount = Math.ceil(itemCount*step/100);\r\n\t\tvar start = dataRanges.start, to = dataRanges.to;\r\n\t\tif(dataRanges.to > chartBox.datas.length-1) {\r\n\t\t\tto = dataRanges.to - changeCount;\r\n\t\t\tstart = dataRanges.start - changeCount;\r\n\t\t}else {\r\n\t\t\tchartBox.zoom = true;\r\n\t\t\t//放大\r\n\t\t\tif(e.deltaY > 0) {\r\n\t\t\t\tstart  = dataRanges.start + changeCount;\r\n\t\t\t}else {\r\n\t\t\t\tstart = dataRanges.start - changeCount;\r\n\t\t\t}\r\n\t\t}\r\n\t\tvar ret = wheelOpts.onWheelBefore&&wheelOpts.onWheelBefore.call(chartBox)\r\n\t\tif(ret!==false) {\r\n\t\t\tchartBox.painter({start: start, to: to},function(){\r\n\t\t\t\tchartBox.autoLoadData();\r\n\t\t\t});\r\n\t\t\twheelOpts.onWheel&&wheelOpts.onWheel.call(chartBox,dataRanges);\r\n\t\t}\r\n\t\t\r\n\t\te.stopPropagation();\r\n\t}\r\n}\r\n\r\nmodule.exports = WheelEvent;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/WheelEvent.js\n ** module id = 11\n ** module chunks = 0\n **/","/*!\r\n * jQuery Mousewheel 3.1.13\r\n * https://github.com/jquery/jquery-mousewheel/blob/master/jquery.mousewheel.min.js\r\n * Copyright 2015 jQuery Foundation and other contributors\r\n * Released under the MIT license.\r\n * http://jquery.org/license\r\n */\r\n!function(a){\"function\"==typeof define&&define.amd?define([\"jquery\"],a):\"object\"==typeof exports?module.exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type=\"mousewheel\",\"detail\"in g&&(m=-1*g.detail),\"wheelDelta\"in g&&(m=g.wheelDelta),\"wheelDeltaY\"in g&&(m=g.wheelDeltaY),\"wheelDeltaX\"in g&&(l=-1*g.wheelDeltaX),\"axis\"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,\"deltaY\"in g&&(m=-1*g.deltaY,j=m),\"deltaX\"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,\"mousewheel-line-height\");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,\"mousewheel-page-height\");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?\"floor\":\"ceil\"](j/f),l=Math[l>=1?\"floor\":\"ceil\"](l/f),m=Math[m>=1?\"floor\":\"ceil\"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&\"mousewheel\"===a.type&&b%120===0}var e,f,g=[\"wheel\",\"mousewheel\",\"DOMMouseScroll\",\"MozMousePixelScroll\"],h=\"onwheel\"in document||document.documentMode>=9?[\"wheel\"]:[\"mousewheel\",\"DomMouseScroll\",\"MozMousePixelScroll\"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:\"3.1.12\",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,\"mousewheel-line-height\",k.getLineHeight(this)),a.data(this,\"mousewheel-page-height\",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,\"mousewheel-line-height\"),a.removeData(this,\"mousewheel-page-height\")},getLineHeight:function(b){var c=a(b),d=c[\"offsetParent\"in a.fn?\"offsetParent\":\"parent\"]();return d.length||(d=a(\"body\")),parseInt(d.css(\"fontSize\"),10)||parseInt(c.css(\"fontSize\"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind(\"mousewheel\",a):this.trigger(\"mousewheel\")},unmousewheel:function(a){return this.unbind(\"mousewheel\",a)}})});\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/vendor/jquery.mousewheel.min.js\n ** module id = 12\n ** module chunks = 0\n **/","/**\r\n * 画移动十字线\r\n */\r\n\r\nvar $ = require('jquery');\r\nvar core = require('./common.js');\r\nvar FollowTip = require('./FollowTip');\r\n\r\n\r\nfunction CrossLineEvent(canvas,chartBox){\r\n\t\tthis.canvas = canvas;\r\n\t\tthis.chartBox = chartBox;\r\n\t\tthis.ctx = canvas.getContext('2d');\r\n\t\tthis.init();\r\n\t}\r\n\t\r\n\tCrossLineEvent.prototype = {\r\n\t\tconstructor: CrossLineEvent,\r\n\t\r\n\t\tinit: function(){\r\n\t\t\tvar me = this;\r\n\t\t\tthis.canvas.clear = true;\r\n\t\r\n\t\t\tvar followOps = this.chartBox.events.crossLine.follow;\r\n\t\t\tif(followOps){\r\n\t\t\t\tthis.followTip = new FollowTip(this.chartBox.canvasBox,followOps);\r\n\t\t\t}\r\n\t\r\n\t\t\tvar tempMove = core.throttle(me.mousemove,30);\r\n\t\t\t$(this.canvas).on('mousemove',function(e){\r\n\t\t\t\ttempMove.call(me,e);\r\n\t\t\t}).on('mouseleave',function(e){\r\n\t\t\t\tme.mouseout.call(me,e,true,true);\r\n\t\t\t}).on('mouseenter',function(e){\r\n\t\t\t\tif(window.mouseMoveLocked) return ;\r\n\t\t\t\tme.mouseenter.call(me,e);\r\n\t\t\t})\r\n\t\r\n\t\t},\r\n\t\tmouseenter: function(e) {\r\n\t\t\tthis.mouseIn = true;\r\n\t\t\te.stopPropagation();\r\n\t\t},\r\n\t\tmousemove: function(e){\r\n\t\t\tvar ctx = this.ctx, chartBox = this.chartBox;\r\n\t\t\tif(chartBox.dragging||!this.mouseIn) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t\tthis.mouseout.call(this);\r\n\t\t\t//ctx.clearRect(0, 0, this.canvas.width,this.canvas.height);\r\n\t\t\tvar pageX = e.pageX, pageY = e.pageY;\r\n\t\t\tvar offset = $(this.canvas).offset();\r\n\t\r\n\t\t\tvar pos = {\r\n\t\t\t\tx: pageX - offset.left,\r\n\t\t\t\ty: pageY - offset.top,\r\n\t\t\t}\r\n\t\r\n\t\t\tvar drawInfo = this.draw(pos);\r\n\t\t\tvar eventOpts = chartBox.events.crossLine||{};\r\n\t\t\tif(eventOpts.onCross&&drawInfo) {\r\n\t\t\t\teventOpts.onCross.call(chartBox,drawInfo);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t},\r\n\t\tmouseout: function(e,out,triggle) {\r\n\t\t\tthis.ctx.clearRect(0, 0, this.canvas.width,this.canvas.height)\r\n\t\t\tif(this.followTip) {\r\n\t\t\t\tthis.followTip.hideTip();\r\n\t\t\t\tthis.followTimer&&clearTimeout(this.followTimer);\r\n\t\t\t\tthis.followTimer = null;\r\n\t\t\t}\r\n\t\t\tvar eventOpts = this.chartBox.events.crossLine||{};\r\n\t\t\tif(eventOpts.onAfterCross&&triggle) {\r\n\t\t\t\teventOpts.onAfterCross.call(this.chartBox);\r\n\t\t\t}\r\n\t\t\tif(out) {\r\n\t\t\t\tthis.mouseIn = false;\r\n\t\t\t}\r\n\t\t\tif(e) {\r\n\t\t\t\te.stopPropagation();\r\n\t\t\t}\r\n\t\t},\r\n\t\tdraw: function(pos){\r\n\t\t\tvar ctx = this.ctx, chartBox = this.chartBox;\r\n\t\t\t//计算可移动的反而范围\r\n\t\t\tvar chartOpts = chartBox.chartOpts,theme = chartBox.events.crossLine;\r\n\t\t\tvar yAxisWidth = chartOpts.yAxis.width;\r\n\t\t\tvar xAxisHeight = chartOpts.xAxis.height;\r\n\t\r\n\t\t\tvar effectiveX = this.canvas.width - yAxisWidth;\r\n\t\t\tvar effectiveY = this.canvas.height - xAxisHeight;\r\n\t\r\n\t\t\tif(pos.x<0 || pos.y<0 || pos.x > (effectiveX)||pos.y>effectiveY) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\r\n\t\t\tvar adjustX = chartBox.adjustX(pos.x);\r\n\t\t\t\r\n\t\t\tvar areas = chartOpts.areas.items,chartList = chartBox.chartList;\r\n\t\t\tvar mainAreaName = chartOpts.areas.items[0];\r\n\t\t\tvar mainAreaHeight = chartOpts[mainAreaName].height + chartOpts[mainAreaName].top;\r\n\t\t\tif(pos.y > mainAreaHeight) {\t//只在主区域有用\r\n\t\t\t\tchartBox.mouseInfo = null;\r\n\t\t\t}else {\r\n\t\t\t\tchartBox.mouseInfo = {point:{x:pos.x,y:pos.y},index:adjustX.index,width:effectiveX,height:effectiveY};\r\n\t\t\t}\r\n\t\r\n\t\t\t//在别处有用\r\n\t\t\tpos.x = adjustX.x;\r\n\t\t\tvar yVal,area;\r\n\t\t\tfor(var i=0,len=areas.length; i<len; i++) {\r\n\t\t\t\tvar chartObj = chartList[areas[i]];\r\n\t\t\t\tif(chartObj.getValueByY) {\r\n\t\t\t\t\tyVal = chartObj.getValueByY.call(chartObj,pos.y);\r\n\t\t\t\t\tarea = areas[i];\r\n\t\t\t\t\tif(yVal) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//画y轴数据\r\n\t\t\tif(yVal) {\r\n\t\t\t\tthis.drawY(yVal,pos.y);\r\n\t\t\t}\r\n\t\r\n\t\t\t//画x轴数据\r\n\t\t\tvar xValue = chartBox.showDatas[adjustX.index];\r\n\t\t\tif(xValue) {\r\n\t\t\t\tthis.drawX(xValue.quoteTime,pos.x,adjustX.index)\r\n\t\t\t\t//跟随tip\r\n\t\t\t\tif(this.followTip) {\r\n\t\t\t\t\tvar me = this;\r\n\t\t\t\t\tvar delay = this.chartBox.events.crossLine.follow.delay||1000;\r\n\t\t\t\t\tthis.followTimer = setTimeout(function(){\r\n\t\t\t\t\t\tvar fTip = '';\r\n\t\t\t\t\t\tfor(var tip in tipList) {\r\n\t\t\t\t\t\t\tfTip += chartBox.getAreaTip(tip,adjustX.index,true);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tme.followTip.changeTip(fTip,pos,{width:effectiveX,height:effectiveY});\r\n\t\t\t\t\t},delay)\r\n\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn {xValue:xValue.quoteTime,yValue:yVal,yArea:area,index:adjustX.index}\r\n\t\t},\r\n\t\tdrawX: function(xValue,x,dataIndex){\r\n\t\t\tvar ctx = this.ctx, chartBox = this.chartBox;\r\n\t\t\tvar chartOpts = chartBox.chartOpts,theme = chartBox.events.crossLine;\r\n\t\t\t\r\n\t\t\tvar xAxisHeight = chartOpts.xAxis.height;\r\n\t\t\t\r\n\t\t\tvar lineHeight = this.canvas.height - xAxisHeight;\r\n\t\r\n\t\t\tcore.drawVLine(this.ctx, theme.lineColor, x, 0, lineHeight, 'solid');\r\n\t\t\tctx.save();\t\r\n\t\t\tctx.font = theme.font;\r\n\t\t\tvar xValue1 = core.convertDate(xValue,100,true);\r\n\t\t\tchartBox.mouseInfo&&(chartBox.mouseInfo.xValue = xValue1);\r\n\t\t\tvar w = ctx.measureText(xValue1).width;\r\n\t\t\tvar boxW = w+20;\r\n\t\t\tctx.fillStyle = theme.background;\r\n\t\t\tvar boxX = Math.max(x- boxW/2,0)\r\n\t\t\tctx.fillRect(boxX , lineHeight+2, boxW, xAxisHeight-2);\r\n\t\t\tctx.fillStyle = theme.color;\r\n\t\t\tctx.fillText(xValue1, boxX+10, this.canvas.height-10);\r\n\t\t\tctx.restore();\r\n\t\t\tvar tipList = chartBox.tipList;\r\n\t\t\tfor(var tip in tipList) {\r\n\t\t\t\tvar ele = tipList[tip];\r\n\t\t\t\tvar msg = chartBox.getAreaTip(tip,dataIndex);\r\n\t\t\t\tele.html(msg);\r\n\t\t\t}\r\n\t\t},\r\n\t\r\n\t\tdrawY: function(Yvalue,y) {\r\n\t\t\tvar ctx = this.ctx, chartBox = this.chartBox;\r\n\t\t\tvar chartOpts = chartBox.chartOpts,theme = chartBox.events.crossLine;\r\n\t\r\n\t\t\tvar yAxisWidth = chartOpts.yAxis.width;\r\n\t\t\tvar lineWidth = this.canvas.width - yAxisWidth;\r\n\t\r\n\t\t\tchartBox.mouseInfo&&(chartBox.mouseInfo.yValue = Yvalue);\r\n\t\t\tcore.drawHLine(ctx, theme.lineColor, 0, y, lineWidth, 'solid');\r\n\t\t\tctx.save();\r\n\t\t\tctx.fillStyle = theme.background;\r\n\t\t\tctx.fillRect(lineWidth+1, y-10, yAxisWidth, 20);\r\n\t\t\tctx.fillStyle = theme.color;\r\n\t\t\tctx.font = theme.font;\r\n\t\t\tctx.fillText(Yvalue,lineWidth+7, y+5);\r\n\t\t\tctx.restore();\r\n\t\t},\r\n\t\r\n\t\r\n\t\tdrawByValue: function(crossInfo) {\r\n\t\t\tvar chartBox = this.chartBox;\r\n\t\t\tvar x = chartBox.getXByValue(crossInfo.xValue);\r\n\t\t\tvar y = chartBox.getYByValue(crossInfo.yValue,crossInfo.yArea,true);\r\n\t\t\tthis.ctx.clearRect(0, 0, this.canvas.width,this.canvas.height);\r\n\t\t\tif(x.index) {\r\n\t\t\t\tthis.drawX(crossInfo.xValue,x.x,x.index);\r\n\t\t\t}\r\n\t\t\tif(y) {\r\n\t\t\t\tthis.drawY(crossInfo.yValue,y);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t}\r\n\t}\r\n\r\nmodule.exports = CrossLineEvent;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/CrossLineEvent.js\n ** module id = 13\n ** module chunks = 0\n **/","/**\r\n * 鼠标跟随显示信息\r\n */\r\n\r\nvar $ = require('jquery');\r\n\r\nfunction FollowTip($element,opts){\r\n\tthis.container = $element;\r\n\tthis.opts = opts;\r\n\tthis.dir = {x:1,y:1};\r\n\treturn this.init();\r\n}\r\n\r\nFollowTip.prototype = {\r\n\tconstructor: FollowTip,\r\n\tinit: function(){\r\n\t\tvar opts = this.opts;\r\n\t\tif(!opts.width||!opts.height) {\r\n\t\t\tconsole.log('请设置高度或者宽度');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tvar cls = opts.clsName ||''\r\n\t\tthis.wrap = $('<div class=\"canvas-follow-tip '+cls+'\" style=\"display:none; position: absolute; left:0; top:0; width:'+opts.width+'px; height:'+opts.height+'px\"></div>').appendTo(this.container);\r\n\t\treturn this;\r\n\t},\r\n\r\n\tcalcPosition: function(pos,region){\r\n\t\tvar opts = this.opts;\r\n\t\tif(opts.position) {\r\n\t\t\treturn opts.position;\r\n\t\t}\r\n\t\tvar wrapWidth,wrapHeight;\r\n\t\tif(region) {\r\n\t\t\twrapWidth = region.width;\r\n\t\t\twrapHeight = region.height;\r\n\t\t}else {\r\n\t\t\twrapWidth = this.container.width();\r\n\t\t\twrapHeight = this.container.height();\r\n\t\t}\r\n\t\tvar margin = opts.margin||0, top=0 ,left=0 ;\r\n\t\tif(this.dir.y) {\r\n\t\t\ttop = pos.y + margin;\r\n\t\t\tif(top > wrapHeight - opts.height - margin) {\r\n\t\t\t\tthis.dir.y = 0;\r\n\t\t\t\ttop = pos.y - opts.height - margin;\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\ttop = pos.y - opts.height- margin;\r\n\t\t\tif(top < opts.height+margin) {\r\n\t\t\t\tthis.dir.y = 1;\r\n\t\t\t\ttop = pos.y + margin;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif(this.dir.x) {\r\n\t\t\tleft = pos.x + margin;\r\n\t\t\tif(left > wrapWidth - opts.width - margin) {\r\n\t\t\t\tthis.dir.x = 0;\r\n\t\t\t\tleft = pos.x - opts.width - margin;\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\tleft = pos.x - opts.width - margin;\r\n\t\t\tif(left < opts.width + margin) {\r\n\t\t\t\tthis.dir.x = 1;\r\n\t\t\t\tleft = pos.x + margin;\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\r\n\t\treturn {top:top,left:left};\r\n\t\t\r\n\t},\r\n\r\n\thideTip: function(){\r\n\t\tthis.wrap.hide();\r\n\t},\r\n\r\n\tshowTip: function(){\r\n\t\tthis.wrap.show();\r\n\t},\r\n\tchangeTipPosition: function(pos,region){\r\n\t\tvar tipPos = this.calcPosition(pos,region);\r\n\t\tthis.wrap.css(tipPos);\r\n\t},\r\n\tchangeTip: function(tip,pos,region) {\r\n\t\tthis.changeTipPosition(pos,region);\r\n\t\tif(tip) {\r\n\t\t\tthis.wrap.html(tip);\r\n\t\t}\r\n\t\tthis.showTip();\r\n\t}\r\n}\r\n\r\nmodule.exports = FollowTip;\r\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/FollowTip.js\n ** module id = 14\n ** module chunks = 0\n **/","/**\r\n * 右键点击事件\r\n */\r\n\r\nvar $ = require('jquery');\r\nvar FollowTip = require('./FollowTip');\r\n\r\n\r\nfunction RightClickEvent(canvas,chartBox){\r\n\tthis.canvas = canvas;\r\n\tthis.ctx = canvas.getContext('2d');\r\n\tthis.chartBox = chartBox;\r\n\tthis.dynamicMenu = [];\r\n\r\n\treturn this.init();\r\n}\r\n\r\nRightClickEvent.prototype = {\r\n\tconstructor: RightClickEvent,\r\n\tinit: function(){\r\n\t\tvar opts = this.chartBox.events.rightClick, me = this;\r\n\t\tif(!opts.menus||!opts.menus.length) {\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\t//生成菜单\r\n\t\tthis.initRightMenuHtml();\r\n\t\t//绑定菜单事件\r\n\t\tthis.initMenuEvents();\r\n\t\t//绑定右键出现菜单事件\r\n\t\tthis.bindRightClickEvent();\r\n\r\n\t\t//当点击页面其他地方时，要隐藏菜单\r\n\t\t$(document).on('click.rightClick',function(){\r\n\t\t\tme.rightMenuObj.hide();\r\n\t\t\tme.rightDialog.hideTip.call(me.rightDialog);\r\n\t\t});\r\n\t\treturn this;\r\n\t},\r\n\r\n\tinitRightMenuHtml: function(){\r\n\t\tvar me = this,chartBox = this.chartBox,opts = chartBox.events.rightClick;\r\n\t\t\r\n\t\t//主菜单\r\n\t\tvar menus = opts.menus;\r\n\t\tvar fragment = document.createDocumentFragment(),height=menus.length*40+2;\r\n\t\tvar mainMenu = document.createElement('div');\r\n\t\tmainMenu.className = 'main-menu';\r\n\t\tfor(var i=0,menu; menu = menus[i++];) {\r\n\t\t\tvar a = this.factoryMenu(menu,i-1);\r\n\t\t\tmainMenu.appendChild(a);\r\n\t\t}\r\n\t\tfragment.appendChild(mainMenu);\r\n\r\n\t\t//二级菜单\r\n\t\tvar subMenus = opts.subMenus;\r\n\t\tif(subMenus) {\r\n\t\t\tvar subMenu = document.createElement('div');\r\n\t\t\tsubMenu.className = 'sub-menu';\r\n\t\t\tsubMenu.style.display ='none';\r\n\t\t\tfor(var j=0,submenu;submenu = subMenus[j++];) {\r\n\t\t\t\tvar a = this.factoryMenu(submenu);\r\n\t\t\t\tsubMenu.appendChild(a);\r\n\t\t\t}\r\n\t\t\tfragment.appendChild(subMenu);\r\n\r\n\t\t\tif(opts.onClick) {\r\n\t\t\t\t$(subMenu).on('click','a',function(e){\r\n\t\t\t\t\topts.onClick.call(this,me.rightMenuObj.activeMainMenu);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}\r\n\r\n\r\n\r\n\t\tthis.rightDialog = new FollowTip(this.chartBox.canvasBox,{\r\n\t\t\twidth:218,\r\n\t\t\theight: height,\r\n\t\t\tmargin:5,\r\n\t\t\tclsName:'chart-right-menu'\r\n\t\t});\r\n\t\t\r\n\t\tthis.rightDialog.wrap.append(fragment);\r\n\t},\r\n\r\n\tfactoryMenu: function(menu,index) {\r\n\t\tvar type = typeof menu;\r\n\t\tvar a = document.createElement('a');\r\n\t\ta.href=\"javascript:void(0)\";\r\n\t\tif(type=='object') {\r\n\t\t\tvar tpl = menu.tpl;\r\n\t\t\tvar fn = $.type(tpl) =='function';\r\n\t\t\tif(fn) {\r\n\t\t\t\tthis.dynamicMenu.push({index:index,ele:a});\r\n\t\t\t}else {\r\n\t\t\t\ta.innerHTML = tpl;\r\n\t\t\t}\r\n\t\t\tif(menu.submenu) {\r\n\t\t\t\ta.submenu = true;\r\n\t\t\t}\r\n\r\n\t\t\tif(menu.click) {\r\n\t\t\t\tvar me = this;\r\n\t\t\t\t$(a).on('click',function(){\r\n\t\t\t\t\tmenu.click.call(this,me,me.chartBox.mouseInfo.yValue);\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t}else {\r\n\t\t\ta.innerHTML = menu;\r\n\t\t}\r\n\r\n\t\treturn a;\r\n\t},\r\n\r\n\tinitMenuEvents: function(){\r\n\t\tvar wrap = this.rightDialog.wrap;\r\n\t\tthis.rightMenuObj = new RightMenus(wrap);\r\n\t},\r\n\r\n\tbindRightClickEvent: function(){\r\n\t\tvar dynamicMenu = this.dynamicMenu,chartBox = this.chartBox, me = this, mainMenus = chartBox.events.rightClick.menus;\r\n\t\t$(this.canvas).on('contextmenu',function(e){\r\n\t\t\tme.rightMenuObj.hide();\r\n\t\t\tvar mouseInfo = chartBox.mouseInfo;\r\n\t\t\tif(!mouseInfo) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t//更新菜单\r\n\t\t\tfor(var j=0,cur;cur=dynamicMenu[j++];){\r\n\t\t\t\tvar index = cur.index;\r\n\t\t\t\tvar tpl = mainMenus[index].tpl.call(cur.ele,me,mouseInfo.yValue);\r\n\t\t\t\tif(cur.ele.submenu) {\r\n\t\t\t\t\ttpl +='<i class=\"icon icon-triangle-right\"></i>';\r\n\t\t\t\t}\r\n\t\t\t\t$(cur.ele).html(tpl);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tme.rightDialog.changeTipPosition(mouseInfo.point, {width: mouseInfo.width, height: mouseInfo.heihgt});\r\n\t\t\tme.rightDialog.showTip();\r\n\r\n\t\t\treturn false;\r\n\t\t})\r\n\t},\r\n\r\n\tdestory: function(){\r\n\t\t$(document).off('.rightClick');\r\n\t}\r\n\r\n}\r\n\r\n\r\n\r\nfunction RightMenus(wrap,opts) {\r\n\tthis.wrap = $(wrap);\r\n\tthis.subMenu = this.wrap.find('.sub-menu');\r\n\tthis.mainMenu = this.wrap.find('.main-menu');\r\n\tthis.activeMainMenu = null;\r\n\tthis.leaveTimer = null;\r\n\tthis.opts = opts;\r\n\tthis.init();\r\n}\r\nRightMenus.prototype = {\r\n\tinit: function(){\r\n\t\tvar me  = this;\r\n\t\tvar mainMenus = this.mainMenu.find('a');\r\n\r\n\t\tmainMenus.on('mouseenter',function(){\r\n\t\t\t$(this).addClass('active');\r\n\t\t\tme.activeMainMenu = this;\r\n\t\t\tvar more = this.submenu||$(this).data('submenu');\r\n\t\t\tif(more) {\r\n\t\t\t\tvar borderWidth = parseInt(me.wrap.css('borderWidth'));\r\n\t\t\t\t\r\n\t\t\t\tvar top = $(this).position().top-borderWidth;\r\n\t\t\t\tme.subMenu.css('top',top).show();\r\n\t\t\t}else {\r\n\t\t\t\tme.subMenu.hide();\r\n\t\t\t}\r\n\t\t}).on('mouseleave',function(){\r\n\t\t\tvar more = this.submenu||$(this).data('submenu');\r\n\t\t\tif(!more) {\r\n\t\t\t\t$(this).removeClass('active');\r\n\t\t\t\tme.subMenu.hide();\r\n\t\t\t\tme.activeMainMenu = null;\r\n\t\t\t\t\r\n\t\t\t}else {\r\n\t\t\t\tvar _self = this;\r\n\t\t\t\tme.leaveTimer&&clearTimeout(me.leaveTimer);\r\n\t\t\t\tme.leaveTimer = setTimeout(function(){\r\n\t\t\t\t\t$(_self).removeClass('active');\r\n\t\t\t\t\tif(me.activeMainMenu == _self) {\r\n\t\t\t\t\t\tme.activeMainMenu = null;\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t})\r\n\r\n\t\tthis.subMenu.on('mouseenter',function(){\r\n\t\t\tme.leaveTimer&&clearTimeout(me.leaveTimer);\r\n\t\t}).on('mouseleave',function(){\r\n\t\t\t$(me.activeMainMenu).removeClass('active');\r\n\t\t\tme.activeMainMenu = false;\r\n\t\t\t$(this).hide();\r\n\t\t})\r\n\t\t\r\n\t},\r\n\r\n\thide: function(){\r\n\t\tthis.activeMainMenu&&$(this.activeMainMenu).removeClass('active');\r\n\t\tthis.activeMainMenu = null;\r\n\t\tthis.subMenu.hide();\r\n\t}\r\n}\r\n\r\nmodule.exports = RightClickEvent;\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./src/RightClickEvent.js\n ** module id = 15\n ** module chunks = 0\n **/"],"sourceRoot":""}